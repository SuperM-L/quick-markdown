# 报表示例手册V5

**报表**：报表是用来**展示数据**的**文档或电子表格**。

它可以**显示各种类型的数据**，如**数字、文本、图表、图片**等，用来**帮助**做**决策**、**分析业务趋势**和**评估绩效**。报表通常会从**一个或多个数据源**中**获取数据**，经过**处理后生成**。它可以**按时间、地理位置、产品**等维度进行**分类**，并**提供交互**功能，让用户能够自己**探索数据**。报表还可以**自动更新**，根据需求**定期或实时生成**。

常见的报表包括**财务报表、销售报表、生产报表和人力资源报表**等。

# 起步



## 第一步：进入设计器

1. **打开报表管理-报表设计**

   ![image-20230425151934579](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_e1284e1baf532dcd995b05fa6a127f04.png)

2. **报表管理**

   此处可以对已有报表进行管理，包括重新设计、预览查看、删除报表

   ![image-20230427150317193](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_90c559df7fcf682381f5780e5d4ca7c9.png)

3. **新建报表**：进入设计器页面

   ![image-20230425151958607](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_cb67dcc96f45081d69e627c4a8a47701.png)

## 第二步：**设计器页面介绍**

![image-20230425152135996](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_4291fef81b630175109b92b397569bfe.png)

##### **左侧栏**

包含**数据集、数据字典、报表信息**

1. **数据集**：**数据的集合**，用于在**报表中显示的数据**，如下图就是一个数据集及对应的数据库数据。包括sql、api、javabean、json数据集四种，**本手册使用sql和javabean数据集**，具体可参见**第三步关于数据集**的介绍
1. 将id拖动到设计器中的一个单元格后，其表现形式和数据库显示相同


   ![image-20230506093329777](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_bece78384e54a5dea5c0d9e4fcb08359.png)

   ![image-20230506093346963](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_b0e2a1b118e2240e7040aa679a971781.png)

   ![image-20230506093301337](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_83e15bc76e8cb2b346b5465c23339768.png)

2. **数据字典**：**翻译数据集中的数据**，例如数据集中有表示男性性别的0，女性性别的1，但是0、1不利于阅读，使用数据字典将0翻译为男性，1翻译为女性便于阅读，关于**字典的配置、使用可参见附录**

   ![image-20230427151542968](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_18751dabe89b6fde43257d6ee4437e2f.png)

   ![image-20230506093720342](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_6efabb911ba64237894c18947c28fd85.png)

3. **报表信息**：包含**报表**的**名称设置、类型设置**

   

##### **设计区域（重要）**

用于**设计报表样式**、**放置数据集数据**

![image-20230427151849694](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_ed1a8cf0c3713fa19655f071eb6c832e.png)

1. **单元格**：每个小格子都是一个单元格

   ![image-20230428095745509](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_fcfa624d305b83c0d5a28c77ee38e19c.png)

2. **单元格位置**：如下图第一行是大写字母，第一列是数字，使用字母+数字标识单元格位置。如下图B6

   ![image-20230428100010642](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_777fc31ad38f8af78f7f6830ca996f31.png)

3. **选中单元格**：

   1. **单选**：**鼠标左键点击一个单元格**，即可单选

      ![image-20230428100151700](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_35b3a14e39083aa64c4be25cf8f685d7.png)

   2. **多选**：鼠标**左键长按拖动**，即可多选

      ![image-20230428100238976](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_aff2898937cc114ec1ae4fc0ba69c66a.png)

4. **操作单元格**：对上述**选中的单元格**进行操作，例如对**选中区域添加边框线**。操作方式有三种：

   1. 使用上方工具栏：具体见下方详细解释
   2. 鼠标右键：具体见下方详细解释
   3. 右侧属性栏：具体见下方详细解释

   ![image-20230428100518471](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_2cc8ad995cf818e3808e1a6e540e6bf6.png)

5. **鼠标右键菜单**：此处仅列举基础功能，后续功能在使用时具体介绍，参看示例中对应示例

   ![image-20230506094315275](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_49df932615493b98e5cac1c7db410832.png)

   * 复制/剪切：复制/剪切 单元格中的数据+样式。剪切与复制区别：**剪切**后使用粘贴功能原单元格数据+样式**都会消失**，**复制**后使用粘贴功能原单元格数据+样式**不会消失**

   * 粘贴：复制/剪切的数据+样式**都粘贴到新的单元格中**

   * 粘贴数据：复制/剪切的数据+样式中的**数据粘贴到新单元格中**

   * 粘贴格式：复制/剪切的数据+样式中的**样式粘贴到新单元格中**

     ![image-20230506095202652](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_769592120d7a65f70bf66355cc470c82.png)

   * 插入行：在选中的单元格上方增加一行空行

     ![image-20230506095543437](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_03855fb2f55021bfdcd8544e5453dcaf.png)

   * 插入行：在选中的单元格左方增加一列空行

     ![image-20230506095717570](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_903113706b87d32967774ba58c4fdbda.png)

   * 删除所在行、列：删除选中单元格所在的那一行或列

   * 删除数据：删除选中单元格中的所有数据，格式不变

##### **上方工具栏**

对**选中单元格**进行**样式的设计**，比如字体大小颜色设置、边框、对齐等

![image-20230506100141034](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_d5d61551a112c5b45039da13cdd63fff.png)

1. **预览**：设计报表后可以查看效果

   ![image-20230506100341262](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_e404bfc2fdabfc98c7e21ed01b198171.png)

2. **保存**：

   ![image-20230506100416311](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_dd2df9c9adf9160d5e7402929badc61a.png)

3. **撤回、恢复**：撤回到上一步、回到上一步后重新恢复到下一步

   ![image-20230506100535207](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_9d8349d88eb24c2184536da45ce53625.png)

4. **格式刷**：选中一个设计好样式的区域，点击格式刷，再点击无样式的区域，产生一个相同样式的区域

   ![image-20230506100810419](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_f9f9b0fed436580d5a3472c4b4086cc1.png)

5. **清除格式**：选中单元格后，点击清除样式，不删除数据的情况，将单元格样式设置为无样式

   ![image-20230506100929287](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_7b4009200e6c710d462a21f49b08824a.png)

6. **数据格式**：搭配数据集使用，暂不多描述，结合示例学习使用

   ![image-20230506105621543](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_821eb10d8a65de9fe543852e8d7d211f.png)

7. **字体、字号、加粗、斜体、下划线、删除线、字体颜色**：效果如下

   ![image-20230506103142613](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_d62d5b37510f19d7aa5059fdecbf5ea1.png)

8. **填充颜色**：给选中单元格设置背景颜色

   ![image-20230506103325910](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_d4f8a218440ead9add7ab3d76a18a2fd.png)

9. **单元格边框**：给选中单元格设置边框

   ![image-20230506103401431](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_db571ac8659e24923d1e36ac998c384f.png)

10. **合并单元格**：将选中的多个单元格合并为一个

    ![image-20230506103536047](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_703a88cd3de691e784cac796f696832b.png)

11. **对齐**：左对齐、居中对齐、右对齐，默认左对齐

    ![image-20230506103710559](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_ed2480ba028e71159e7588be0c96e60f.png)

12. **垂直对齐**：上、中、下对齐，默认居中

    ![image-20230506103834870](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_a665bd76919c6fef52774443bca2dcde.png)

13. **自动换行**：内容超过单元格宽度自动换行。同样内容，自动换行和不换行如下

    ![image-20230506104141506](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_98518d11556dda23217ce8066ca702d1.png)

14. **单元格表达式**：函数表达式，在单元格使用表达式实现特殊需求，例如求和、获取当前时间、求平均值等，不多描述，具体参考示例使用

    ![image-20230506104324000](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_61b9cf87fc279bc715731855ba687b4a.png)

15. **单元格斜线**：讲一个单元格分为多个区域：效果如下

    ![image-20230506104640988](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_5a87dbab0801c651dfe9ddfc4ab58324.png)

16. 图表、图片、二维码：

    ![image-20230506104957794](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_b84ddeb1b1828d9795b41b98e6ca1dd5.png)

17. **上传**：将本地的Excel表格使用该设计器打开

    ![image-20230506105052732](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_6a85db32a228230e9861e7c606d2fa98.png)

18. **打印设置**：打印时设置纸张宽度大小、页边距等

    ![image-20230506105138498](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_f232246f71cc45e04db57baba00ea8f2.png)



##### **右侧属性栏**

用于更**详细的样式设计**：

该文档中主要使用了宽高值设置，对选中单元格设置宽高。对于合并的单元格无法设置这两个属性，合并的单元格可以通过改变同行或同列其他单元格来设置该值

![image-20230506105831812](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_1c28ae9d7e991468adef30de3a187b40.png)

## 第三步：**数据集介绍**

报表的**数据集是用于生成报表的一组数据**，以便在报表中进行展示和分析。例如某公司所有员工的信息就是一个数据集，可以通过报表表格将这些信息展示出来

**掌握基础创建数据集即可，也可跳过，在示例中熟练该节内容**

#### sql数据集

说明：通过SQL查询从数据库获取数据

![image-20230417161925222](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_4f0e829c8a377fb4e62aa3a1458a022e.png)

##### 前端配置：

###### 第一步：**数据库选择（重要，必做）**

1. 在sql数据集配置页中，**打开侧边栏**，进行**数据源配置**

   ![image-20230516110441729](报表示例V5_Img/image-20230516110441729.png)=》![image-20230516110600968](报表示例V5_Img/image-20230516110600968.png)

2. **选择数据库**：以下两种方式

   * **下拉选择已配置好的数据库**

     ![image-20230516110702175](报表示例V5_Img/image-20230516110702175.png)

   * 或者点击**维护-新增-配置数据库连接，配置其他数据库**，然后再在上述下拉选择中选择新增的数据库

![image-20230516111034863](报表示例V5_Img/image-20230516111034863.png)

###### 第二步：**获取数据**

1. 使用sql查询**获取数据**：以下两种方式，**前提**都是**已经选择好数据库**

   * **自动sql**：

     1. 在数据库下方的表查询输入框中**输入**想要的**数据表名**，点击**查询**
     2. **单击**需要的数据表表名
     3. 此时自动在右侧报表sql中生成了**全查询的sql**（此时也**可以手动修改**）
     4. 点击sql**解析**即可解析出数据

   * **手动sql**：

     1. 直接在右侧报表sql中**手写sql**
     2. 点击sql**解析**即可解析出数据

     ![image-20230516111631086](报表示例V5_Img/image-20230516111631086.png)

2. 关于**sql**语句中的**参数**：

   1. 报表sql下方四个提示的运用
   1. **参考第六步中的说明**

   ![image-20230516111702643](报表示例V5_Img/image-20230516111702643.png)

###### 第三步：编码、名称配置

1. **编码**保证唯一（重要），用于**系统识别数据集** ：例如 userData **不要使用特殊字符和_**

2. **名称**，便于**用户识别数据集**：例如 用户信息

   ![image-20230516112028688](报表示例V5_Img/image-20230516112028688.png)

3. 配置结果用途如下，

   1. **蓝色方框中**的内容为上述配置的**名称**，主要便于用户识别是哪个数据集
   2. 将**左侧红框中的两个user_id和user_name**分别使用鼠标**拖动到右边单元格**中，可看到**右侧红框中的值**#{userData.user_id}和#{userData.user_name}，其中的userData就是上述配置的编码

   ![image-20230516111901266](报表示例V5_Img/image-20230516111901266.png)



###### 第四步：集合、分页配置

1. **是否集合**：决定配置好的数据集数据数量、使用**#{}**还是**${}**进行引用
   1. **勾选**：**引用方式#{}**，查询出**多条数据**
   2. **不勾选**：**引用方式${}**，只会查询出**一条数据**

![image-20230516113301911](报表示例V5_Img/image-20230516113301911.png)

![image-20230426111358433](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_88c88c70aacbd2d498ab343ade5d911a.png)

![image-20230426111343206](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_8aaf6cda8a904867fd8e1c7b701a62b7.png)

2. **分页**：决定**查询**数据是**是否分页**，默认分页为1页10条；不分页则查询所有数据，**数据量大时很慢**

   1. 分页是基于集合的，如果不是集合，则只有一个数据，也就谈不上分页了

   2. 因此**必须勾选集合才能决定是否分页**

      ![image-20230516113420525](报表示例V5_Img/image-20230516113420525.png)

   3. 分页和不分页的结果示例

      ![image-20230421153755976](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_85e75f4122931883b9491a1f32683403.png)

###### 第五步：**解析结果面板-报表字段明细**

下方依次解释字段名、字段文本、排序、类型、字典code、查询、查询模式、查询默认值、查询日期格式、参数配置

![image-20230421152035054](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_594faff359c8ad4025097d4c9b7a377c.png)

1. **报表字段明细有哪些字段**取决于查询sql**查询的字段**，报表字段明细中的字段也是**报表**中**可以使用的字段**

2. **排序**：各个字段在报表设计器的显示顺序，如下图user_name排序设置为0后确定，回到设计器发现user_name位于第一个了

   ![image-20230516114256088](报表示例V5_Img/image-20230516114256088.png)

   ![image-20230516114317988](报表示例V5_Img/image-20230516114317988.png)

3. **字段名、字段文本**：

   ![image-20230516114455012](报表示例V5_Img/image-20230516114455012.png)

   如下图，拖动**字段文本**到报表中，显示为：#{**数据集编码.字段名**} 的形式

   ![image-20230516115045367](报表示例V5_Img/image-20230516115045367.png)

4. **类型**：

   1. 需要**搭配查询使用**，勾选查询，设置类型为日期类型

      ![image-20230426112127717](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_362e20f377169d5764e3fc60a3c56dfd.png)

   2. 在报表预览界面，查询栏可以看到**输入类型为日期选择**

      ![image-20230426112238702](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_4e37caee949da2821d736b73cea39de8.png)

5. **字典code**：数据集中数据如果有字典，可在字典code中填写对应的字典名，能自动解析字典值

   例如原始数据**sex值为0、1、2**，配置对应字典后，将**0、1、2解析为男、女、未知**

   ![image-20230421154122917](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_8d481e1844b8f052fc8c0d30159889cb.png)

6. **查询**：勾选后，在生成的报表中可以筛选数据

   ![image-20230417170316679](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_25633d4158e070df8c5fc06c3ecef94f.png)

7. **查询模式**：决定上述**查询框的样式**：下拉框还是输入框或者其他，如下拉框模式

   ![image-20230421155818731](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_65386d7485e5ffb5ca0cd6bf451a88d8.png)

8. **查询默认值**：设置后，打开报表时默认的查询条件，如用户编号查询默认值设置为1后，打开报表默认只显示用户编号为1的用户

   ![image-20230421160221458](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_8d57602b3058c1028de8b35f2692b80a.png)

9. **查询日期格式**：

   1. 需要**类型设置为日期类型、勾选查询、设置时间格式yyyy-MM-dd HH:mm:ss**

      ![image-20230426102008078](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_e4b5e340efabdf5f58463b32c2ae7071.png)

   2. **效果**

      ![image-20230426102303230](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_8915dcbbb8b281c735d8137112118551.png)

10. **参数配置**：查询搭配使用，类似部门选择，多级菜单选择的方式

    ![image-20230426113440808](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_6837d7541221d01d4393993a15b787ee.png)

###### 第六步：报表参数

1. **参数配置**：

   1. 再sql中使用参数：sex为参数，使用 ${sex} 引用该参数，sex为字符串时需要加单引号：'${sex}'

      ```
      select *  from sys_user where sex='${sex}'
      ```

   2. 解析后自动将该参数加载到报表参数页面

      ![image-20230426104235286](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_da6697b6b3fd1826d64ee27d0aa91eef.png)



2. **传入参数**：在预览报表页面，地址栏的**url**后**拼接** 

   此例的sex值为0、1、2三个值代表男、女、未知，查询男性sex=0，女性sex=1，未知sex=2

   * 拼接方式 ： **&sex=0** （以查询男性为例sex=0）
   * 传入改参数后，结果中只存在男性结果

   ![image-20230426105420120](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_cef8fa51dfca4d7aa9311fa7866d8d2e.png)

###### 第七步：数据预览

**查看**部分上述sql查询出的**数据**

![image-20230426103935433](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_2a8e71dbee5e98c0b53e99ca97065e40.png)

###### 第八步：保存及使用

1. 点击右下角保存数据集
2. 报表设计页面：左侧栏中找到配置的数据集，选择所需数据，拖拽到单元格使用数据

![image-20230421160837526](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_9b8ec0c8563f0b8f4282d379baf6128c.png)

------



#### javabean数据集

说明：使用javabean的获取数据的数据集。此处描述与sql数据集不同之处，相同之处见sql数据集的配置

**用于获取后端bean中处理好的数据**

##### 后端配置：

###### **第一步**：新建一个java类

```java
//此处省略包

public class UserReportJavaBeanDemo {
}
```



###### **第二步**：实现IDataSetFactory、创建常量

```java
//此处省略包

//实现IDataSetFactory接口
public class UserReportJavaBeanDemo implements IDataSetFactory {
    /**
     * 自定义参数常量sex(自定义)
     */
    private static final String SEX="sex";
    /**
     * 自定义参数常量nickName(自定义)
     */
    private static final String NICK_NAME="nickName";
    /**
     * 常量pageSize（必须）
     */
    private static final String PAGE_SIZE="pageSize";
    /**
     * 常量pageNo（必须）
     */
    private static final String PAGE_NO="pageNo";
    /**
     * 常量defaultPageSize
     */
    private static final String DEFAULT_PAGE_SIZE="10";
    /**
     * 常量defaultPageNo
     */
    private static final String DEFAULT_PAGE_NO="1";
    /**
     * 总数据条数（必须）
     */
    private int total;
    
    @Override
    public List<Map<String, Object>> createData(Map<String, Object> param) {
        return null;
    }

    @Override
    public TiPage createPageData(Map<String, Object> param) {
        return null;
    }
}
```

###### **第三步**：注册bean

1. **添加bean的注解**，两种方式（以类UserReportJavaBeanDemo为例）：

   * @Component("UserReportJavaBeanDemo")：指定bean名称为UserReportJavaBeanDemo

   * 使用@Component，不指定bean名称则使用时默认bean为类名小写userReportJavaBeanDemo

```java
//此处省略包

//添加bean的注解，注意@Component("UserReportJavaBeanDemo")中UserReportJavaBeanDemo指定bean名称；
//如果使用@Component，不会指定bean名称，则使用时默认bean为类名小写userReportJavaBeanDemo
@Component("UserReportJavaBeanDemo")
public class UserReportJavaBeanDemo implements IDataSetFactory {
    //此处省略常量
    @Override
    public List<Map<String, Object>> createData(Map<String, Object> param) {
        return null;
    }

    @Override
    public TiPage createPageData(Map<String, Object> param) {
        return null;
    }
}

```



###### **第四步**：创建getData公共方法（重要）

主要修改此方法即可

```java
	/**
     * 根据参数获取数据,公共方法getData传入param和sysUsers
     * @param param
     * isPage 是否分页
     * @return
     */
    public List<Map<String, Object>> getData(Map<String, Object> param,boolean isPage){
        //结果集
        ArrayList<Map<String, Object>> result = new ArrayList<>();
        //获取自定义参数
        Object sex = param.get(SEX);
        Object nickName = param.get(NICK_NAME);
        
        //创建一个查询对象
        SysUser sysUser = new SysUser();
        //查询对象设置查询条件
        //判断自定义查询参数sex非空
        if (sex != null) {
            //性别过滤
            sysUser.setSex((String) sex);
        }
        //判断自定义查询参数nickName非空
        if (nickName != null) {
            //昵称过滤
            sysUser.setNickName((String) nickName);
        }
        
        //获取数据
        List<SysUser> sysUsers;
        //不分页
        if(!isPage){
            sysUsers = sysUserService.selectDeptUserList(sysUser);
            total = sysUsers.size();
        }else {//分页
            int pageSize = Integer.parseInt(param.get(PAGE_SIZE).toString());
            int pageNo = Integer.parseInt(param.get(PAGE_NO).toString());

            TableSupport.startPage(pageNo,pageSize);
            com.github.pagehelper.Page page = (com.github.pagehelper.Page) sysUserService.selectUserList(sysUser);
            sysUsers = page.getResult();
            total = (int) page.getTotal();
        }

        //转换为json格式、格式化时间字段
        SimpleDateFormat f = new SimpleDateFormat(MyDateUtils.YYYY_MM_DD_HH_MM_SS);
        sysUsers.stream().forEach(user->{
            Map<String, Object> jsonUser = (Map<String, Object>) JSONObject.toJSON(user);
            //需要用到时间字段时，必须格式化时间为字符串格式
            if (user.getCreateTime() != null) {
                jsonUser.put("createTime",f.format(user.getCreateTime()));
            }
            if (user.getUpdateTime() != null) {
                jsonUser.put("updateTime",f.format(user.getUpdateTime()));
            }
            result.add(jsonUser);
        });
        return result;
    }
```



###### **第五步**：重写createData方法

**重新写createData不分页结果集**：**不勾选分页时执行的方法**，无必要可以不改动此方法

![image-20230426113832400](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_33fce2dfa815c4caaebecb3f18b1267f.png)

```java
//此处demo使用sys_user表作为数据源，使用@Autowired注解引入ISysUserService，根据需要使用对应service
@Autowired
private ISysUserService sysUserService;

@Override
//重写createData不分页结果集
public List<Map<String, Object>> createData(Map<String, Object> param) {
    //不分页第二个参数传false
   return getData(param,false);
}
```

###### **第六步**：重写createPageData

**重写createPageData分页结果集**：**勾选分页时执行的方法**，无必要可以不改动此方法

![image-20230426113842298](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_a0bc176406597c97ce21403f0888d3b3.png)

```java
	/**
     * 返回分页数据
     * @param param
     * @return
     */
    @Override
    public TiPage createPageData(Map<String, Object> param) {
        //分页设置
        TiPage tiPage = new TiPage();
        Object paramSize = param.get(PAGE_SIZE);
        Object paramNo = param.get(PAGE_NO);
        paramSize = paramSize == null?DEFAULT_PAGE_SIZE:paramSize;
        paramNo = paramNo ==null?DEFAULT_PAGE_NO:paramNo;
        int pageSize = Integer.parseInt(param.get(PAGE_SIZE).toString());
        int pageNo = Integer.parseInt(param.get(PAGE_NO).toString());
        //获取数据，需要分页所以第二个参数传true
        List<Map<String, Object>> result = getData(param, true);

        tiPage.setPageNo(pageNo);
        tiPage.setPageSize(pageSize);
        tiPage.setPages(total%pageSize==0?total/pageSize:total/pageSize+1);
        tiPage.setTotal(total);
        tiPage.setRecords(result);
        return tiPage;
    }	
```

###### 两个完整bean示例：

**注**：对于IncomeReportJavaBeanDemo这个类，需要根据report_demo_income.sql生成report_demo_income表，再生成代码得到domain、service、mapper.java、mapper.xml之后才能创建bean获取示例收入数据

* IncomeReportJavaBeanDemo：

  ```java
  @Component("IncomeReportJavaBeanDemo")
  public class IncomeReportJavaBeanDemo implements IDataSetFactory {
      /**
       * 自定义参数常量region
       */
      private static final String REGION="region";
      /**
       * 常量pageSize
       */
      private static final String PAGE_SIZE="pageSize";
      /**
       * 常量pageNo
       */
      private static final String PAGE_NO="pageNo";
  
      /**
       * 总数据条数
       */
      private int total;
      @Autowired
      private IReportDemoIncomeService reportDemoIncomeService;
  
      /**
       * 不分页数据
       * @param param
       * @return
       */
      @Override
      public List<Map<String, Object>> createData(Map<String, Object> param) {
          return getData(param,false);
      }
  
      /**
       * 分页数据
       * @param param
       * @return
       */
      @Override
      public TiPage createPageData(Map<String, Object> param) {
          //分页设置
          TiPage tiPage = new TiPage();
          int pageSize = Integer.parseInt(param.get(PAGE_SIZE).toString());
          int pageNo = Integer.parseInt(param.get(PAGE_NO).toString());
          //获取数据
          List<Map<String, Object>> result = getData(param, true);
  
          tiPage.setPageNo(pageNo);
          tiPage.setPageSize(pageSize);
          tiPage.setPages(total%pageSize==0?total/pageSize:total/pageSize+1);
          tiPage.setTotal(total);
          tiPage.setRecords(result);
          return tiPage;
      }
  
      /**
       * 获取数据
       * @param param
       * @param flag
       * @return
       */
      private  List<Map<String, Object>> getData(Map<String, Object> param,Boolean flag) {
          //获取自定义参数
          Object region = param.get(REGION);
  
          ArrayList<Map<String, Object>> result = new ArrayList<>();
  
          //获取收入数据
          ReportDemoIncome reportDemoIncome = new ReportDemoIncome();
          List<ReportDemoIncome> reportDemoIncomes;
          //根据region过滤,这里的region是前端传过来的参数,其他参数也可以这样处理
          if (region != null) {
              reportDemoIncome.setRegion(String.valueOf(region));
          }
  
          if(!flag){
              reportDemoIncomes = reportDemoIncomeService.selectReportDemoIncomeList(reportDemoIncome);
              total = reportDemoIncomes.size();
          }else {
              int pageSize = Integer.parseInt(param.get(PAGE_SIZE).toString());
              int pageNo = Integer.parseInt(param.get(PAGE_NO).toString());
  
              TableSupport.startPage(pageNo,pageSize);
              com.github.pagehelper.Page page = (com.github.pagehelper.Page) reportDemoIncomeService.selectReportDemoIncomeList(reportDemoIncome);
              reportDemoIncomes = page.getResult();
              total = (int) page.getTotal();
          }
  
          //转换成map
          reportDemoIncomes.stream().forEach(item->{
              result.add((Map<String, Object>) JSONObject.toJSON(item));
          });
  
          return result;
      }
  
  }
  
  ```

  

* UserReportJavaBeanDemo

  ```java
  @Component("UserReportJavaBeanDemo")
  public class UserReportJavaBeanDemo implements IDataSetFactory {
      /**
       * 自定义参数常量sex
       */
      private static final String SEX="sex";
      /**
       * 自定义参数常量nickName
       */
      private static final String NICK_NAME="nickName";
      /**
       * 常量pageSize
       */
      private static final String PAGE_SIZE="pageSize";
      /**
       * 常量pageNo
       */
      private static final String PAGE_NO="pageNo";
  
      private int total;
      @Autowired
      private ISysUserService sysUserService;
  
      /**
       * 返回不分页数据
       * @param param
       * @return
       */
      @Override
      public List<Map<String, Object>> createData(Map<String, Object> param) {
          return getData(param,false);
      }
  
      /**
       * 返回分页数据
       * @param param
       * @return
       */
      @Override
      public TiPage createPageData(Map<String, Object> param) {
          //分页设置
          TiPage tiPage = new TiPage();
          int pageSize = Integer.parseInt(param.get(PAGE_SIZE).toString());
          int pageNo = Integer.parseInt(param.get(PAGE_NO).toString());
          //获取数据
          List<Map<String, Object>> result = getData(param, true);
  
          tiPage.setPageNo(pageNo);
          tiPage.setPageSize(pageSize);
          tiPage.setPages(total%pageSize==0?total/pageSize:total/pageSize+1);
          tiPage.setTotal(total);
          tiPage.setRecords(result);
          return tiPage;
      }
  
      /**
       * 根据参数获取数据,公共方法getData传入param和sysUsers
       * @param param
       * isPage是否分页
       * @return
       */
      public List<Map<String, Object>> getData(Map<String, Object> param,boolean isPage){
          ArrayList<Map<String, Object>> result = new ArrayList<>();
          //获取参数
          Object sex = param.get(SEX);
          Object nickName = param.get(NICK_NAME);
          SysUser sysUser = new SysUser();
          //判断sex非空
          if (sex != null) {
              sysUser.setSex((String) sex);
          }
          //判断nickName非空
          if (nickName != null) {
              sysUser.setNickName((String) nickName);
          }
          List<SysUser> sysUsers;
          if(!isPage){
              sysUsers = sysUserService.selectDeptUserList(sysUser);
              total = sysUsers.size();
          }else {
              int pageSize = Integer.parseInt(param.get(PAGE_SIZE).toString());
              int pageNo = Integer.parseInt(param.get(PAGE_NO).toString());
  
              TableSupport.startPage(pageNo,pageSize);
              com.github.pagehelper.Page page = (com.github.pagehelper.Page) sysUserService.selectUserList(sysUser);
              sysUsers = page.getResult();
              total = (int) page.getTotal();
          }
  
          SimpleDateFormat f = new SimpleDateFormat(MyDateUtils.YYYY_MM_DD_HH_MM_SS);
          //转换为json格式
          sysUsers.stream().forEach(user->{
              Map<String, Object> jsonUser = (Map<String, Object>) JSONObject.toJSON(user);
              //必须格式化时间为字符串格式
              if (user.getCreateTime() != null) {
                  jsonUser.put("createTime",f.format(user.getCreateTime()));
              }
              if (user.getUpdateTime() != null) {
                  jsonUser.put("updateTime",f.format(user.getUpdateTime()));
              }
              result.add(jsonUser);
          });
          return result;
      }
  
  
  }
  
  ```

  



##### 前端配置：

###### **第一步**：新增javabean数据集

![image-20230421143602518](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_17f44c0782d937b37eb271b2c8e9cbc7.png)

###### **第二步**：填写编码、名称

详情参考sql数据集

- **编码**保证唯一（重要），用于**系统识别数据集** ：例如 userData **不要使用特殊字符和_**
- **名称**，便于**用户识别数据集**：例如 用户信息
- **是否集合**：`否`为单数据；`是`为多数据列表，
- **是否分页**：勾选集合前提下，需要对多条数据分页，则需要勾选“是否分页”

![image-20230421145813324](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_5b8798d558f1249d3fd28cbc57715dec.png)

###### **第三步**：解析javabean

1. **类型**：
   1. spring-key：javabean格式
   2. java-class：java类格式

2. **值：**
   1. javabean：两种形式（以类UserReportJavaBeanDemo为例）

      * 后端使用@Component("UserReportJavaBeanDemo")，则bean名称为指定模式，即bean为UserReportJavaBeanDemo

      * 后端使用@Component，则bean名称为默认模式，默认为类名首字母小写即userReportJavaBeanDemo

   2. java-class:
      1. 填写**完整包名.类名**，如：需要注意的是该方式会导致@autowire自动引入的bean空指针
         1. com.tienon.trdp.common.demo.report.UserReportJavaBeanDemo
         2. com.tienon.trdp.common.demo.report.IncomeReportJavaBeanDemo

###### 第四步：明细配置

具体可参考sql数据集

###### 第五步：报表参数

1. **新增字段参数**，例如IncomeReportJavaBeanDemo中的地区字段region，需要在javabean中处理了region，如查询时过滤，如下

   ```java
           //根据region过滤,这里的region是前端传过来的参数,其他参数也可以这样处理
           if (region != null) {
               reportDemoIncome.setRegion(String.valueOf(region));
           }
   ```

   ![image-20230504150844803](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_822b4d2b81a362abe0c4bc92ef86a1a4.png)

2. 在预览报表时，可以在地址后传入改参数及参数的值，交给后端进行一些处理，例如进行数据过滤

   ![image-20230504171216385](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_d855c16eebd60d932d5cbdd0dd635337.png)

3. 后端bean中的getData方法可以获取这个参数及参数值，例如此处的region参数，在查询数据时对数据进行了地区过滤

   ```java
   /**
        * 获取数据
        * @param param
        * @param flag
        * @return
        */
       private  List<Map<String, Object>> getData(Map<String, Object> param,Boolean flag) {
           //获取自定义参数
           Object region = param.get(REGION);
   
           //省略......
           
           //根据region过滤,这里的region是前端传过来的参数,其他参数也可以这样处理
           if (region != null) {
               reportDemoIncome.setRegion(String.valueOf(region));
           }
   
           if(!flag){
               reportDemoIncomes = reportDemoIncomeService.selectReportDemoIncomeList(reportDemoIncome);
               total = reportDemoIncomes.size();
           }else {
               //省略.....
               com.github.pagehelper.Page page = (com.github.pagehelper.Page) reportDemoIncomeService.selectReportDemoIncomeList(reportDemoIncome);
               //省略.....
       }
   ```

4. **参数使用**：在报表预览中，地址栏的末尾添加参数值：&region=西南，可以过滤出地区为西南的数据

   ![image-20230504171216385](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_d855c16eebd60d932d5cbdd0dd635337.png)



###### 第六步：数据集使用

拖拽到想要显示的单元格即可

![image-20230426101016132](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_0e5429ace72ce12c07269f0297462a01.png)

# 示例

## 数据报表

### 数据库表

1. 示例依赖该数据表：report_demo_income.sql：用于**交叉报表、分组小计报表**、**图形报表**示例数据

### 1. 用户列表数据报表（javabean）

#### **描述**

**基础数据报表**，将数据以表格的形式呈现，每一行代表一个记录，每一列代表一个字段，每个单元格代表一个字段在某个记录中的值，帮助用户更加直观地了解数据，从而进行数据分析和决策

#### 示例图

![image-20230426114832404](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_fc9a81f671bea1ffb96752f22eaf2471.png)

#### 第一步：创建javabean数据集(详情见起步数据集介绍)

1. **选择添加javabean数据集**

2. **填写唯一编码、名称**、**取消勾选是否分页**（详情见起步数据集介绍）

3. **填写javabean名称**，**UserReportJavaBeanDemo类的配置参见起步数据集介绍javabean数据集的配置**

   ![image-20230425154057614](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_54114c97b426b8cb9f794b536d4283da.png)

   ![image-20230504102202168](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_cf7e10e82c1d836a76735be2ff938937.png)

4. **设置性别字典code**，使报表能将存储的性别0、1转化为男、女，此处sex的字典code填写为：**sys_user_sex**，此值来源于数据字典，详情**见附录数据字典**

   ![image-20230425160357309](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_37d7cd5f5cc8709ed2116fbb84751f09.png)

5. **明细配置**

   **此例**配置是**预览**时的**查询栏**的**查询配置**

   1. 更改**字段文本为中文名、勾选查询**

   2. **性别查询**模式为**下拉单选**、查询**默认值为1**

   3. 如下图设置，详细介绍请参起步中的数据集配置

      ![image-20230425160622083](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_af16c522d8a6b76eac8963fb0b244f00.png)

      ![image-20230425160548408](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_008313ac128a6447bbf4d100489ec8bd.png)

   4. 预览**效果**如下

      1. **勾选查询**的字段会出现在**预览时的查询栏**中
      2. **字段文本为对应的名称**
      3. **查询模式对应输入框的类型**， 昵称是输入框，性别是下拉框
      4. **默认值对应输入框中默认内容**，上述查询默认值1对应性别字典中的女

      ![image-20230423134824740](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_46689ae5cda2696b8e596f6262ed6344.png)

   

6. 点击右下角确定保存数据集

   * 出现以下内容则配置成功

   ![image-20230423135044347](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_32d6aa171fb301ac800839eca16a4b5f.png)

7. 其他：如果**配置有误**，可进行**修改**或者**删除**上述数据集

   ![image-20230421172743795](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_e0ae17a56cc073651b45918a7c5d7e5a.png)

   

#### 第二步：表格样式设计

1. 将**第一行**作为表头，填入表头内容

2. 根据需要**表头内容**此处使用了序号、姓名、年龄、邮箱、手机号、性别，**双击单元格**，然后**输入内容**

3. **表头颜色**：鼠标左键长按从序号拖动到性别，**选中上述表头**，再使用**填充工具填充颜色**

   ![image-20230421172930061](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_ccfdf635b007d7005de56990ad01b839.png)

4. **表格边框**：鼠标左键长按从序号拖动到性别，再**往下多选中一行**，使用**边框工具，选择所有边框**

   ![image-20230421173328283](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_16220f4280935a936cc65d2c09e36d59.png)

#### 第三步：添加数据

* **序号**：需要使用函数：**双击**序号下的那个单元格输入：**=row()**，注意括号时英文输入下的括号:区别：中文：（），**英文：()**
* **其他**：直接从左侧**用户数据数据集**拖拽对应的数据字段**到单元格**中

![image-20230421173538655](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_ff5c1bb707603aa77cf1156060f9f9e6.png)

#### 第四步：保存、预览

1. **保存**：点击**保存按钮**，填写报表的名字（自定义），选择报表的**分类为数据报表**
2. **预览**：点击**预览按钮**，**预览**查看报表效果

![image-20230423094809766](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_b096e6b87a5e2fac07ebcf98e6fbff06.png)

![image-20230423094650703](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_feff46a88079905edc7c488bd875bf3c.png)

![image-20230426114832404](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_fc9a81f671bea1ffb96752f22eaf2471.png)

***



### 2.用户表单示例（sql）

#### **描述**

**基础明细报表**，使用数据集将**用户数据**加载到表格中，且**每个用户的信息独占一个表格**，方便查看单个用户详细的、具体的数据，更加简洁明了

#### 示例图

![image-20230423114257274](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_8c3e62943d8674baed9b13fbc702a848.png)

#### 第一步：创建sql数据集(详情见起步数据集介绍)

1. **选择添加sql数据集**

2. **左侧点击向右的箭头**

   ![image-20230509135934947](报表示例V5_Img/image-20230509135934947.png)

3. **选择数据库**

4. **选择数据表（以sys_user表为例）**

5. **填写唯一编码、名称**、**取消勾选是否分页**（详情见起步数据集介绍）

   ![image-20230421094233615](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_568b88d8a077b6f797aa44ec8bda9689.png)

   ![image-20230421172128039](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_2173553b41426d5480f727bb61b4a8c6.png)

6. **设置性别字典code**，使报表能将存储的性别0、1转化为男、女：sys_user_sex，此值来源于数据字典，详情**见附录数据字典**

   ![image-20230420173440307](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_87ccb083e2af58aa57f8f550a273b6cc.png)

7. **勾选查询**，如下

   ![image-20230423135243681](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_482d55ae0604b8128a819c8b0a89d5a1.png)

8. 点击右下角确定保存数据集

   * 出现以下内容则配置成功

   ![image-20230423135044347](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_32d6aa171fb301ac800839eca16a4b5f.png)

9. 其他：上述**配置有误**，可进行**修改**或者**删除**上述数据集

   ![image-20230421172743795](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_e0ae17a56cc073651b45918a7c5d7e5a.png)

#### 第二步：表格样式设计

1. 先按下图输入**表头**

   ```
   员工身份证登记表 受理单位（盖章）XX市公安局 姓名 性别 民族 手机号 年龄 出生日期 家庭住址 证件类型 证件号码  备注 XX公安部治安管理局治
   ```

   ![image-20230423100057885](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_9d3b6115f758501fc0f78bb717678602.png)

2. **合并单元格**

   1. 按下图**八个红框分别选中**，并使用箭头所指**分别合并单元格工具**，进行单元格合并

      1. **注意：是选中一个框合并一次单元格，总共选中、合并八次**


      ![image-20230423101201684](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_0cadc18543455f95da367ef7118d3628.png)

   2. 结果如下图

      ![image-20230423103953119](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_af241ac1a32c35fc88569099de3d4731.png)

3. **设置边框**

   1. 从姓名开始，长按鼠标左键拖拽到选中如图区域，使用**边框工具-所有边框**设置边框

      ![image-20230423104212795](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_3c31eabd1237cc2aba4fb3055fbb1679.png)

   2. 结果如图

      ![image-20230423104428982](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_eb4c6128ed550b3e8cdebc9075d3af20.png)

   

4. **设置对齐**

   1. 如下图设置标题、表头、表尾对齐：

      1. **“员工身份证登记表”单元格设置居中对齐**

      2. **“受理单位（盖章）XX市公安局”单元格设置左对齐**

      3. **“XX公安部治安管理局治”单元格设置右对齐**


      ![image-20230423104754970](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_c13ea25c76d57f44a9cbb13ac00e4152.png)

   2. 下图红框内容**居中对齐**

      ![image-20230423105732263](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_340cacb69c45824d19418c31a020e39e.png)

   3. 结果如下图

      ![image-20230423105841252](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_c66e7d9c696b92d3603bbfd055ff43c2.png)

5. **字体样式设置**

   1. **报表标题**：

      1. **增大**第一行标题的单元格**高度**

      2. 选中标题“员工身份证登记表”区域，**设置字体为15**、**设置字体加粗**

         ![image-20230423110040842](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_a53697083073ec572d1fb94c19a0b0e7.png)

   2. **字体颜色**设置

      1. 选中“受理单位（盖章）XX市公安局”单元格，设置字体颜色如图

      2. 选中“XX公安部治安管理局治”单元格，设置字体颜色如图

         ![image-20230516140708650](报表示例V5_Img/image-20230516140708650.png)
      
   
6. **单元格格式设置**

   1. 选中出生日期后一单元格：**设置长日期格式**

   2. 选中出生日期后第二个单元格，如图大红框即**头像设置为图片格式**

      ![image-20230423110620892](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_b33b3385baecc8d2c4b0d1719b23fc35.png)

#### 第三步：添加数据

拖拽**对应的数据**到表头下

![image-20230423111123159](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_ab0920ecf16db8624717ee5f1ace0035.png)

#### 第四步：调整位置

1. 鼠标右键点击A处，**插入行**

2. 鼠标右键点击A处，**插入列**

   ![image-20230423111903122](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_980baff9dc9f94f782754ab85504257d.png)

3. 结果如下，多出一行、一列

   ![image-20230423113832868](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_ef1a650a2db49e38720569f27fa91e49.png)

#### 第五步：设置循环（重要）

1. 选择如下区域，**多选择一行**作为间隔，**鼠标右键下滑找到 循环块-设定**

   ![image-20230423113955608](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_f7190bfef4eb7c0fa94c78f59d9773a7.png)

2. 结果，设置成功后有**循环块**字样

   ![image-20230423114037832](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_4d774d5557cf977dae2a66936e706687.png)

#### 第六步：保存、预览

![image-20230423111256873](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_677134f008d9fb37351ff9a491c58b51.png)

![image-20230423114257274](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_8c3e62943d8674baed9b13fbc702a848.png)

***



### 3. 基本图表示例

##### 描述

常用的统计图表，柱形图、饼图、折线图等

见下方**图形报表分类**中的**基本图表示例**

***



### 4. 交叉报表示例（sql）

##### 描述

交叉报表是指将一个或多个维度（如时间、地区、产品类型等）和一个或多个指标（如销售额、利润等）进行交叉分析，以展示它们之间的关系。交叉报表也被称为交叉表或透视表，是数据分析和决策支持中常用的一种报表类型。

**该例是将年、月 与 地区、省份交叉得到对应的销售收入数据**

#### **示例图**

![image-20230425011857346](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_5bc347abe913a95148883d3cef732795.png)

#### 第一步：创建sql数据集(详情见起步数据集介绍)

需要表数据sql（或类似数据）：report_demo_income.sql

1. **选择添加sql数据集**

2. **左侧点击向右的箭头**

   ![image-20230509135934947](报表示例V5_Img/image-20230509135934947.png)

3. **选择数据库**

4. **选择数据表（以report_demo_income表为例）**

5. **填写唯一编码、名称**、**取消勾选是否分页**（详情见起步数据集介绍）

   ![image-20230421094233615](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_568b88d8a077b6f797aa44ec8bda9689.png)

   ![image-20230425173328032](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_d754f80c65cea85712cc571f1d732871.png)

6. 点击右下角确定保存数据集

7. 其他：上述**配置有误**，可进行**修改**或者**删除**上述数据集

   ![image-20230426134246601](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_7948e158b8798d6514b03d06f77618fb.png)

#### 第二步：表格样式设计

1. **表头内容**

   1. **合并**：长按鼠标左键拖拽选择如下区域（四个格子），使用**合并单元单元格工具合并**

      ![image-20230425005035006](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_990137397ba4f886a9d7b8edeb72f8f9.png)

   2. **单元格斜线工具设计斜线**：填写如下内容：区域|收入|时间 ，选择从左上角作为起点

      ![image-20230425005116056](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_bd8beb5ae5c813310b24032a385331b4.png)

      ![image-20230425005207071](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_d69ac204cca57f646fa2b3bdac0ed79e.png)

   3. **效果**

      ![image-20230425005252799](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_bc7d6c0bb974b62d2f826640b541e9dc.png)

   4. **其他表格内容**：总计

      ![image-20230425010225810](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_c707a729abef84b8cb910bc1efbdff0c.png)

   5. **合并总计单元格**：如下区域

      ![image-20230425010326084](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_67f76c9745f7b6a81b6d693931f1ff97.png)

      

2. **样式设计**

   1. **设置边框**：长按鼠标左键拖拽选择如下区域，使用**边框工具-全部边框**

      ![image-20230425010411966](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_63f472b58aff05583ee3a36465699db1.png)

   2. **背景色设置**：

      1. 长按鼠标左键拖拽选择如下区域，使用**填充工具-填充颜色**

         ![image-20230425005939801](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_0339a930681737982ed6179e8ae82e37.png)

      2. 长按鼠标左键拖拽选择如下区域，使用**填充工具-填充颜色**

         ![image-20230425011019074](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_83b6797af37d598282a1190c3eccc8dd.png)

      3. 长按鼠标左键拖拽选择如下区域，使用**填充工具-填充颜色**

         ![image-20230425011056099](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_cc849e071d7ca1060c9ba36762213ff4.png)

#### 第三步：添加数据

1. 如下图拖拽左侧数据集中数据到对应表格中

   ![image-20230425011229026](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_8e362a8aea65d9348f9547a6330ef1df.png)

2. 合计对应的格子中填写 ： **=SUM(D4)** ，D4是收入对应数据的格子，意义是将收入求和

#### 第四步：设置分组（重要）

**特别注意：配置横向动态分组要素：**

* 目前支持多级表头 ，**最多支持3级**动态的表头
* 必须有横向分组字段：如本示例中`#{p.groupRight(year)}、#{p.groupRight(month)}`
* 横向分组下必须有`动态列`；动态列数据必须设置成`动态属性 例如 #{p.dynamic(main_Income)}`
* 动态列数据之前的列字段必须设置成`纵向分组 例如 #{p.group(provice)}`

1. **设置横向分组**：

   1. 鼠标**选中**如下#{p.groupRight(year)}红框区域，在右侧属性栏中**设置**：**分组设置->聚合方式：分组->扩展方向：横向**
   2. 鼠标分别选中****如下#{p.groupRight(month)}红框区域，在右侧属性栏中**设置**：**分组设置->聚合方式：分组->扩展方向：横向**

   ![image-20230425011535502](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_37501e2771d32a3aad03b5cc609a30fd.png)

2. **设置纵向分组**：

   1. 鼠标选中如下**#{p.group(region)}红框区域**，再在右侧属性栏中设置：**分组设置-聚合方式：分组**
   2. 鼠标选中如下**#{p.group(province)}红框区域**，再在右侧属性栏中设置：**分组设置-聚合方式：分组**

   ![image-20230425011613637](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_4afada145e7dad19abd27650e99b09c3.png)

3. **设置动态属性**：鼠标选中如下红框区域，再在右侧属性栏中设置：**分组设置-高级配置：动态属性**

   ![image-20230425011633032](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_c01695a1492baeaf95abeb2d752b2c5f.png)

#### 第五步：保存、预览

1. 其他**不重要**的设置：添加年、月字样

   ![image-20230425011815880](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_1fbc9eeed340ecfe652a14b54e572f0d.png)

2. 保存、预览

   ![image-20230425011857346](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_5bc347abe913a95148883d3cef732795.png)

***



### 5.  处方单示例

#### **描述**

**基础明细报表**，固定数据表单，主要针对表样式的创建，其中**数据也可使用数据集加载**

#### 示例图

![image-20230424165020292](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_23f94dae6c87bcb45d8a9a52ae6e5177.png)

#### **第一步：**表样式设计

1. **内容**：按以下样例添加表格内容

   ```
   智能医学院处方笺 姓名：李世民 性别：男 年龄：25 单位： 大唐王朝 电话：18888888888 初步诊断： 感冒咳嗽
   RP: 扑热息痛 2.23569 无味红霉素 1 咳平 2 必咳平 49  ABOB 6 VB6 4 赛康定 2
   医嘱： 多喝热水
   医药费 2.56 中成药费 治疗费 检查费 换药费 诊疗费  1.00 注射费 其他 合计 3.56
   医师： 张益达 日期：2020年7月20日
   ```

   ![image-20230424162120681](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_eae5391f2ebeb51e2bc9f7780afc8781.png)

2. **合并单元格**：使用鼠标**左键长按并拖动分别选中**以下**区域**，**分别**使用**合并单元格工具**合并

   1. 具体合并的单元格参照单元格首行字母，该例使用B-M的单元格列
   2. 可在下方3中设置边框后看到更明显的效果

   ![image-20230424162648342](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_5f1f7fc3cfb711f78e6755904b3a3dcb.png)

3. **设置边框**：

   1. 使用鼠标**左键长按并拖动**选中以下**区域**，使用**边框工具-外边框**

      ![image-20230424162730636](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_1d4f398593125f24117fb7ee4368a0b8.png)

   2. 使用鼠标**左键长按并拖动**选中以下**区域**，使用**边框工具-上边框**

      ![image-20230424162934283](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_b1a10ad8586521a211da32e661a93694.png)

   3. 使用鼠标**左键长按并拖动**选中以下**区域**，使用**边框工具-所有边框**

      ![image-20230424162837909](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_8b2d0d0b4265f7d82125d36c614b0dbb.png)

      

   

4. **设置对齐**：

   1. **居中**：使用鼠标**左键长按并拖动分别选中**以下**红框区域**，**分别**使用**水平对齐工具-居中对齐**

   2. **居右**：使用鼠标**左键长按并拖动分别选中**以下**蓝框区域**，**分别**使用**水平对齐工具-右对齐**

      ![image-20230424163414513](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_4d56e40ab44bd2eec0c468e83c91210d.png)

5. **字体设置**：

   1. 红框标题区域：**设置字体为14、加粗**

      ![image-20230424163618464](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_409afb529f28aacc53d7dcea74b3a642.png)

   2. 绿框内容部分：**设置字体为15、加粗**

      ![image-20230424163647407](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_868fca3159609116a43fc179e670053f.png)

   

6. **调整高度、宽度**：拖动以下两个区域中的横线和竖线调整对应单元格的宽度和高度

   ![image-20230424164114485](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_bd8da22fcf0d28450e8a177403bdbe71.png)

   1. 行：

      方法一：使用拖拽调整的方式调整红框所在行的高度为合适

      方法二：点击蓝色方框（第一列，未使用的单元格），在属性栏设置指定高度

      ![image-20230504095054272](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_bfd39e807433f17daf83422d87551764.png)

   2. 列：同理

      方法一：直接拖拽红框中字母左右竖线调整宽度

      方法二：点击蓝色框中的单元格（第一行，未使用的单元格），在属性栏设置指定宽度，具体宽度如图中蓝框中数值

      ![image-20230504101611178](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_fa00f63fc4840aa8ea041598357dad35.png)

   

#### 第二步：表数据

1. **费用合计表达式** ： =SUM(E16,E17,E18,H16,H17,L16,L17,L18)，自动计算出合计费用

2. E16：即横竖交叉点，E列16行，如图红框交叉点

   

![image-20230424164706851](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_2a9b7cb470b2843a924d2ea4eea1e0b3.png)



#### 第三步：保存、预览

![image-20230424165020292](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_23f94dae6c87bcb45d8a9a52ae6e5177.png)

***



### 6. 用户明细分栏表示例（javabean）

#### **描述**

**分栏数据报表**，涉及到分栏、循环的使用，每个用户占一个表格，且一行可显示多个用户表格，此例为一行两个，即分两栏

* 将报表中的数据按两栏显示，**重点在第四步循环**
* 如已**熟练**掌握**表格创建、数据集创建**，可**直接跳转第四步**

#### 示例图

![image-20230424093717469](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_a8dbaa23f7f6f76b36b6928d5d135be9.png)

#### 第一步：创建javabean数据集

1. **选择添加javabean数据集**

2. **填写唯一编码、名称**、**取消勾选是否分页**（详情见起步数据集介绍）

3. **填写javabean名称**，**UserReportJavaBeanDemo类的配置参见起步数据集介绍javabean数据集的配置**

   ![image-20230425154057614](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_54114c97b426b8cb9f794b536d4283da.png)

   ![image-20230504102202168](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_cf7e10e82c1d836a76735be2ff938937.png)

4. **设置性别字典code**，使报表能将存储的性别0、1转化为男、女：**sys_user_sex**，此值来源于数据字典，详情**见附录数据字典**

   ![image-20230425160322506](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_37d7cd5f5cc8709ed2116fbb84751f09.png)

5. 点击**右下角确定**保存数据集

#### 第二步：表格样式设计

1. **内容**：按以下样例输入表格内容

   ```
   用户信息明细表 邮箱： 编号： 用于放置二维码 用户名： 用户类型： 性别： 所在部门： 
   ```

   ![image-20230424091832707](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_9cfc8a5a6edc209a49d5acafac0a5871.png)

2. **合并单元格**：使用鼠标**左键长按并拖动分别选中**以下两个**区域**，**分别**使用**合并单元格工具-合并**

   ![image-20230424092134740](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_328802ceb54e4b93bee215836d90da26.png)

3. **设置对齐**：使用鼠标**左键长按并拖动分别选中**以下四个**区域**，**分别**使用**对齐工具-居中对齐**

   ![image-20230424092332429](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_c7743dfae0a3d2d0b143d114e1e3019d.png)

4. **设置边框**：使用鼠标**左键长按并拖动**选中以下**区域**，使用**边框工具-全部边框**

   ![image-20230424092537236](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_4f5ba8c363b3812dd4f4b6e85f647a85.png)

5. **填充背景色**：使用鼠标**左键长按并拖动分别选中**以下**区域**，**分别填充**如下颜色

   ![image-20230424092724264](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_76af3af1eeb5070eaa30f01c24026276.png)

   

#### 第三步：添加数据

如下将**左侧数据集**中对应的数据使用鼠标左键**拖动**到**右侧表格**中对应位置即可

![image-20230424092955884](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_778c12e4021b8b22492a558dbd69cc39.png)

#### 第四步：设置循环（重点）

作用：只需要**设置一个**用于循环的表格即可，配置循环后会自动生成相同表格不同数据的报表

![image-20230516170647734](报表示例V5_Img/image-20230516170647734.png)

1. 选中**需要重复**的单元格（**红框**），右键下滑找到**循环块-横向循环次数-两次**。此处**多选一行（橙色框）、多选一列（绿色框）**是为了让**上下、左右两个用户**明细中间有**间隔**
2. 设置完成后，在选中区域左上角可以看到有**循环块字样**，且循环区域有**蓝色边框** 
3. **扩展**：**横向循环次数**决定**一行**中的**表格数**，该例开头的**示例图为两栏**（**循环次数为2**），

![image-20230424093249005](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_4a2d509b6e60ff1b3d9e3a488121d7c5.png)

![image-20230424093401822](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_a58f39569bba843bf6e369e67b6ce7b9.png)

![image-20230424093427861](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_6243e235b1d188818cde349b4f7eaf5f.png)

#### 第五步：保存、预览

![image-20230424093717469](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_a8dbaa23f7f6f76b36b6928d5d135be9.png)

***



### 7.  用户注册信息表示例（分版）

#### **描述**

**分版数据报表**，涉及分版功能：使用两个数据集，在同一报表中显示两个不同的表格。设计多个数据集显示，必须分版，否则只会显示一个数据集的数据

* 一个表显示用户信息，一个表显示注册信息。**直接创建**两个表格是**无效**的，**需要进行设置**，

* 如**熟练操作表格创建**，可**跳过第二步、第三步跳转到第四步**

#### 示例图

![image-20230424103905500](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_b0921c6c30a54bd8cb9ab56aa8abc317.png)

#### 第一步：创建数据集

该例需要**两个数据集**，显示两个不同表格

##### 数据集1：用户信息javabean数据集

1. **选择添加javabean数据集**

2. **填写唯一编码、名称**、**取消勾选是否分页**（详情见起步数据集介绍）

3. **填写javabean名称**，**UserReportJavaBeanDemo类的配置参见起步数据集介绍javabean数据集的配置**

   ![image-20230425154057614](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_54114c97b426b8cb9f794b536d4283da.png)

   ![image-20230504102202168](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_cf7e10e82c1d836a76735be2ff938937.png)

4. **设置性别字典code**，使报表能将存储的性别0、1转化为男、女：**sys_user_sex**，此值来源于数据字典，详情**见附录数据字典**

   ![image-20230425160322506](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_37d7cd5f5cc8709ed2116fbb84751f09.png)

5. **勾选查询**：**勾选**user_id、user_name行的**查询选框**

   ![image-20230424100904847](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_df29a7f65d75b8053d102ac306bda2ac.png)

6. **确定**：保存数据集

   

##### 数据集2：注册数据sql数据集

1. **选择添加sql数据集**

2. **左侧点击向右的箭头**

   ![image-20230509135934947](报表示例V5_Img/image-20230509135934947.png)

3. **选择数据库**

4. **选择数据表（以report_demo_income表为例）**

5. **填写唯一编码、名称**、**取消勾选是否分页**（详情见起步数据集介绍）

6. 选择添加sql数据集，选择与以上用户数据相同数据库数据表，解析以下sql，可获得用户对应注册信息（注册时间和人数）

```sql
select 
create_time,
count(user_id) as num
from 
sys_user
group by 
create_time
```

![image-20230421094233615](报表示例V5_Img/img_568b88d8a077b6f797aa44ec8bda9689.png)

![image-20230424101401187](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_fb470b385d4a13536b9400283e9ea469.png)

##### 结果：如下

得到两个数据集

![image-20230424101534203](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_a01119b01d7fe5ebdd7ad8af598ade6b.png)

#### 第二步：表格样式设计

1. **内容**：按以下样例输入表格内容

   ```
   用户注册信息 用户名 性别 邮箱 创建时间  注册时间统计 日期 注册人数
   ```

   ![image-20230424101750268](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_ab6522f97c818cd1c664603dee2d4b38.png)

2. **合并单元格**：使用鼠标**左键长按并拖动分别选中**以下两个**区域**，**分别使用合并单元格工具**合并

   ![image-20230424102245875](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_fb3d8984101ec272a42d48aeefb6fbcd.png)

3. **设置对齐**：使用鼠标**左键长按并拖动分别选中**以下两个**区域**，**分别使用对齐工具-居中对齐**

   ![image-20230424102441946](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_34a22018ddefe440e654b9a477fedd92.png)

4. **设置边框**：使用鼠标**左键长按并拖动分别选中**以下两个**区域**，**分别使用边框工具-全部边框**

   ![image-20230424102619213](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_6534a363ad8bc4046de59c25ab74cc35.png)

5. **填充背景色**：分别选中**蓝色边框填充蓝色**，分别选中**橙色边框区域填充橙色**

   ![image-20230424102913807](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_b494c2e00161016d2a59cc2b42abf273.png)

#### 第三步：添加数据

如下将**左侧数据集**中对应的数据使用鼠标左键**拖动**到**右侧表格**中对应位置即可

![image-20230424103544521](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_48576aac2843b9d6ee4e7be7908332a3.png)

#### 第四步：分版（重点）

* **未分版时，注册时间统计表中是无数据的，必须分版才会显示**

* **分版：**如下图选择需要分版的表格，鼠标右键-下滑找到-**分版-设定**

![image-20230424103712225](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_10790b95647cb20513e2289e58c38ac9.png)

#### 第五步：保存、预览

![image-20230424103905500](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_b0921c6c30a54bd8cb9ab56aa8abc317.png)

***



### 8. 订货单示例

#### **描述**

**基础数据报表**，涉及到报表参数的使用，通过地址栏传参数筛选数据

#### 示例图

![image-20230424172806240](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_c2ee25a7ef07e9968942b4f3fe717990.png)

#### **第一步：**设计表格

1. **内容**：按以下样例添加表格内容

   ```
   订货商信息 订单编号： 订单地址： 订单日期： 订单姓名： 到货日期： 订单详情 定价 优惠价 商品编码 商品名称 销售时间 销售数据量 付款金额 备注： 1、查看信息，在浏览器输入“?did=1”或“?did=2”
   ```

   ![image-20230424170952119](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_dffbb4137a9d942e97a8c0bd59d521f2.png)

2. **合并单元格**：使用鼠标**左键长按并拖动分别选中**以下**区域**，**分别使用合并单元格工具**合并

   ![image-20230424171331526](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_696ce26b9daa8b17af0b78e04ac66929.png)

3. **设置边框**：

   1. 是使用鼠标**左键长按并拖动分别选中**以下**区域**，**分别使用边框工具-所有边框**

      ![image-20230424171447025](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_43bfef9e42576e8057460d7c93ab79be.png)

   2. 使用鼠标**左键长按并拖动分别选中**以下**区域**，**分别使用边框工具-外边框**

      ![image-20230424171529402](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_9f04fca465986757c0b15ee925678a85.png)

   3. 使用鼠标**左键长按并拖动分别选中**以下**区域**，**分别使用边框工具-下边框**

      ![image-20230424171638185](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_8a1d43c7fb520462a627a6db27151e28.png)

   

4. **设置对齐**：

   1. **居中**：使用鼠标**左键长按并拖动分别选中**以下红框**区域**，**分别使用水平对齐工具-居中对齐**

      ![image-20230424171947347](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_028abfe0bca9f63abbcff4a7c8b5b440.png)

5. **字体设置**：

   1. **分别选中**红框标题区域：**分别设置字体为18、加粗**

   ![image-20230424172105541](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_fcc73dafdbb5a0be9128349fc608adc3.png)

   

6. **背景色设置**

   1. 使用鼠标**左键长按并拖动分别选中**以下**区域**，**分别使用填充工具-填充颜色**

      ![image-20230424172235237](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_97971e213653f31015269db3a1fe604d.png)

7. **调整高度、宽度**：**分别拖动**以下两个区域中的横线和竖线调整对应单元格的宽度和高度

   ![image-20230424172752849](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_25d862bf2e35e683ecc89ef3b4231a24.png)

#### 第二步：扩展-动态数据

要达到备注所属效果，需要使用动态数据，此处以各地区收入数据为例

##### 第2.1步：创建数据集(javabean)

1. **选择添加javabean数据集**

2. **填写唯一编码、名称**、**取消勾选是否分页**（详情见起步数据集介绍）

3. **填写javabean名称**，**IncomeReportJavaBeanDemo的配置参见起步数据集介绍javabean的配置**

   ![image-20230425154057614](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_54114c97b426b8cb9f794b536d4283da.png)

   ![image-20230425171315634](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_e15ad267148eea806269eaec124a8f8a.png)

4. **设置报表参数**（**重要**）：新增一条**region参数**（**IncomeReportJavaBeanDemo类中也需要相应的处理，详情见起步数据集介绍javabean数据源配置**）

   ![image-20230426150144057](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_34e1e156f5ca7157ea08a72cf3f24d17.png)

5. 点击右下角确定保存数据集

##### 第2.2步：添加数据

1. 使用鼠标**左键长按并拖动**选中以下区域，**鼠标右键删除所在行**

2. 删除如下区域，留下一行数据区域即可

   ![image-20230426144508914](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_c59379bf2832215e0c3dca224cbbd756.png)

3. 使用鼠标**左键长按并拖动**选中以下区域，**鼠标右键删除数据**

   ![image-20230426144752229](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_cf26296ab0fff9e68ac1f6e42a303216.png)

4. 拖拽对应数据

   ![image-20230426145142667](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_378e682f1b9a9812d5d11d3d974717b2.png)

5. 修改备注

   ```
   1、查看信息，在浏览器输入“&region=华东”或“&region=华西”
   ```

   ![image-20230426150400936](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_fb9a03827023200a97959acadf265fb3.png)

   

##### 第2.3步：预览使用

* **预览报表时，使用参数进行筛选：&region=华北**

![image-20230426150629036](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_9af671dec809cdbeaefb7df8078a4caa.png)

#### 第三步：保存、预览

![image-20230426150825507](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_e817a4983e9bea6651134e4d993d06f4.png)

***



### 9. 纵向分组小计（javabean）

#### **描述**

**分组、小计数据报表**，涉及交叉报表、动态列、动态行、动态数据、求和、分组。横向头和纵向表头（月份、地区、省份）都是动态数据，而不是固定的，，且**自动计算横向、纵向指定数据的和**

#### 示例图

![image-20230426173013567](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_1ee57b7e5d3e8c7c20b3871065510703.png)

#### 第一步：创建数据集(javabean)

1. **选择添加javabean数据集**

2. **填写唯一编码、名称**、**取消勾选是否分页**（详情见起步数据集介绍）

3. **填写javabean名称**，**IncomeReportJavaBeanDemo的配置参见起步数据集介绍javabean的配置**

   ![image-20230425154057614](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_54114c97b426b8cb9f794b536d4283da.png)

   ![image-20230504102712159](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_7c05f164e43ae9cd6aff021d7dbb775c.png)

4. 点击右下角确定保存数据集



#### 第二步：创建表头、设置样式

1. 先按下图输入**表头**

   ![image-20230426171943497](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_dc87aa0df0d3c5cfd7b342576e253793.png)

2. **合并单元格**

   1. 按下图**红框分别选中**，并使用箭头所指**合并单元格工具**，**分别进行单元格合并**

      ![image-20230426171926863](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_8930a31674f1aff7e5265e39a3c60dbb.png)

3. **设置边框**

   1. 长按鼠标左键拖拽到选中如图区域，使用**边框工具-所有边框**设置边框

      ![image-20230426172104880](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_54e8b11e412bc43c0462e52ec616cb61.png)

4. **背景颜色设置**

   1. 长按鼠标左键拖拽到选中如图区域，使用**填充工具**填充背景颜色

      ![image-20230426172159160](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_5f32132b3ae48e028f3f621dd03849cf.png)


#### 第三步：添加数据

1. 拖拽**对应的数据**到表头下
2. 在**#{p.month}后输入月**

![image-20230426172509778](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_98672283aad6be4d7c91913dd62046f7.png)

#### 第四步：设置分组（重要）

1. **设置横向分组（必须）**：鼠标**选中如下红框区域**，再在右侧属性栏中设置：**分组设置-聚合方式：分组-扩展方向：横向**

   * **注：设置横向分组后必须搭配动态属性使用，如下3**

   * 例如四川省有12个月的数据，配置横向分组可以横向显示1-12月

     ![image-20230516160544930](报表示例V5_Img/image-20230516160544930.png)

   ![image-20230426172401196](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_3d6bf18ff2c13f0a479d4e4c383bf5cd.png)

2. **设置纵向分组（必须）**：鼠标**分别选中**如下红框区域，再在**右侧属性栏中分别设置**：**分组设置-聚合方式：分组**

   * **注：使用纵向动态数据时至少设置一个纵向分组**

     ![image-20230426172644039](报表示例V5_Img/img_5ff80917db19993240197bc2c9a488cd.png)

   * **纵向分组作用**：例如将多行相同数据合并显示

     ![image-20230516161136164](报表示例V5_Img/image-20230516161136164.png)![image-20230516161230722](报表示例V5_Img/image-20230516161230722.png)

3. **设置动态属性（必须）**：鼠标**分别选中如下红框区域**，再在**右侧属性栏中分别设置**：**分组设置-高级配置：动态属性**

   **注：设置横向分组后必须搭配动态属性使用**

   ![image-20230426172718371](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_87b0142aa8761a8db635c7eab38e5003.png)

#### 第五步：设置合计（重要）

注：要实现纵向合计，最好如该例有区域和省份类似的两列，**以区域作为分组依据，且设置省份分组设置-聚合方式为分**组，才会**自动**在同一个区域的省份后面**添加合计**

**作用**：以**区域为一组，做一个纵向合计**，对**每行的主要收入和其他收入做横向合计**

![image-20230516163746786](报表示例V5_Img/image-20230516163746786.png)

1. **纵向合计**：

   1. **分组依据设置**：**鼠标选中如下红框区域**，再在右侧属性栏中设置：**小计设置-分组依据：是**

   2. **纵向分组设置**：对**省份下的数据单元格设置分组**，第四步中已经设置，此处不再设置

      ![image-20230426172814422](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_960e38096feba2ba7e879ff1de534f49.png)

      

   3. 鼠标选中如下红框区域，再在右侧属性栏中设置：**小计设置-聚合方式：求和**

      ![image-20230426172844258](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_9af09ccd44f6e1bb710bdce17c9f8f82.png)

      * 对主要收入和其他收入进行**分别求和到合计**

        ![image-20230504115641846](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_25e0292b228deccd4acd40aaa18c3142.png)

   

2. **横向小计**：配置如下红框的值

   1. 将主要收入#{p.dynamic(**mainIncome**)}，其他收入#{p.dynamic(**otherIncome**)}进行求和到小计
   2. **小计为主要收入和其他收入之和，使用函数**：**#{p.compute(mainIncome+otherIncome)}**
   3. **注意**：此处的**p**为**数据集**配置时的**编码**，同主要收入#{p.dynamic(**mainIncome**)}中的p
   
   ![image-20230426172924419](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_f8943e1c352ef718f97bbc006031472f.png)
   
   ![image-20230504115713594](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_7c8938578b5a2c8759b580f7afc2d3f0.png)

#### 第六步：保存、预览

1. 效果示例

   ![image-20230426173027784](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_1ee57b7e5d3e8c7c20b3871065510703.png)

***



### 10. 请假单示例

#### **描述**

**基础数据报表**，固定数据表单，主要针对表样式的创建

#### 示例图

![image-20230424113710946](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_7b72d387a13dd2aa12765b9d2ac55629.png)

#### **第一步：**设计表格

1. **内容**：按以下样例添加表格内容

   ```
   员工请假单 单位： 长江 姓名: 工作岗位: 请选择假类型: 1、年休假:工龄满19年（5天） 2、年休假:工龄满1019年（10天） 3、年休假:工龄满20年（15天） 1、病、事假: 2、病、事假: 3、病、事假: 1、探亲假:未婚探父母（20天） 2、探亲假:已婚探父母（20天） 3、探亲假:探配偶（30天） 1、婚假: 2、晚婚假: 3、丧假: 1、生育假:流产 2、生育假:产假 3、生育假:哺乳假 4、生育假:陪护假探亲地点: 请假时间: 审批人员及意见: 备注: 请假审批表一式两份，考勤员与人力资源部门各存一份
   ```

   ![image-20230424110720863](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_1cd05eedbf17ff5c8389c8b7455823aa.png)

   

2. **合并单元格**：使用鼠标**左键长按并拖动分别选中**以下七个**区域**，**分别使用合并单元格工具**合并

   ![image-20230424112654644](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_68076ed5a624a1043df180255d3b0812.png)

3. **设置边框**：使用鼠标**左键长按并拖动**选中以下**区域**，**使用边框工具-全部边框**

   ![image-20230424112948027](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_0ba421666e146d46710cba78e2fd9d5b.png)

4. **设置对齐**：使用鼠标**左键长按并拖动分别选中**以下两个**区域**，**分别使用对齐工具-居中对齐**

   ![image-20230424113124328](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_3145f2b3f092b9f5d2be58f820f83893.png)

5. **字体设置**：选择如下标题区域，**设置字体为14**，**加粗**

   ![image-20230424113201741](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_ca3f5dae2d5211887f00a5ddb5654bf3.png)

6. **设置自动换行**：使用鼠标**左键长按并拖动选中**以下**区域**，使用**自动换行工具**设置自动换行

   ![image-20230424113256818](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_99f646c7a55f35c3ba4033b0b63e5051.png)

7. **调整高度、宽度**：**分别拖动**以下两个区域中的横线和竖线调整对应单元格的宽度和高度

   ![image-20230424113357407](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_951ce2b133dee002625120e9d620d53c.png)

   ![image-20230424113511037](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_eb19bfeaace13906b10b5567e4340497.png)

#### 第二步：保存、预览

***



### 11. 介绍信示例

#### **描述**

**基础数据报表**，固定数据表单，主要针对表样式的创建

#### 示例图

![image-20230424165140874](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_6123e065a8da61784b93e65a619d32c2.png)

#### **第一步：**设计表格

1. **内容**：按以下样例添加表格内容

   ```
   介绍信 苏州文化局：兹介绍我局 张三和李四 同志 人，前往你处 去查阅关于园林资料 请予接洽并给予帮助。
   单位盖章 （有效时间：2019年8月29日 止) 
   ```

   ![image-20230424133910104](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_f07fc77bc9af480d4d63989fb22ed2e8.png)

2. **合并单元格**：使用鼠标**左键长按并拖动分别选中**以下**区域**，**分别使用合并单元格工具**合并

   ![image-20230424134141108](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_d1e374c06b7faee7ea21718e9991d90e.png)

3. **设置边框**：使用鼠标**左键长按并拖动分别选中**以下**区域**，**分别使用边框工具-下边框**

   ![image-20230424134227940](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_edd1358df76cb037289fe8dd5b95e17c.png)

4. **设置对齐**：

   1. **居中**：使用鼠标**左键长按并拖动分别选中**以下红框**区域**，**分别使用对齐工具-居中对齐**
   2. **居右**：使用鼠标**左键长按并拖动选中**以下蓝框**区域**，**使用对齐工具-右对齐**

   ![image-20230424134614417](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_72a8f4c47a5c32ee410b41d598a8fb87.png)

5. **字体设置**：

   1. 选择如下“介绍信”标题区域（第2行）：**设置字体为22**，**加粗**
   2. 选择主题内容部分（第3-8行）：**设置字体为12，不加粗**

   ![image-20230424115152972](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_7dfb408c6e26ba828e99c329302cc21e.png)

6. **调整高度、宽度**：**分别拖动**以下两个区域中的横线和竖线调整对应单元格的宽度和高度

   ![image-20230424134926130](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_93fdaa4d6b85ed48835aa61c85ce010d.png)

#### 第二步：保存、预览

***



### 12. 逮捕令示例

#### **描述**

**基础数据报表**，固定数据表单，主要针对表样式的创建

#### 示例图

![image-20230424143448864](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_1ae142ee289aa1ffb453dc444850008b.png)

#### **第一步：**设计表格

1. **内容**：按以下样例添加表格内容

   ```
   苏州市经济侦查大队 逮捕令 第123459663号 根据《中华人民共和国刑事诉讼法》第七十八条之规定， 经 批准，兹由我局对涉嫌
   的 (性别 出生日期 执行逮捕，送苏州 市经济侦查大队押。 公安局印 2020年7月5日 
   ```

   ![image-20230424140503039](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_0214ac841833f4ab9e1e5befff52756a.png)

2. **合并单元格**：使用鼠标**左键长按并拖动分别选中**以下**区域**，**分别使用合并单元格工具**合并

   ![image-20230424140920067](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_e11be9561998d172e31bb2f4786469cd.png)

3. **设置边框**：

   1. 使用鼠标**左键长按并拖动**选中以下**区域**，使用**边框工具-外边框**

      ![image-20230424141333120](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_31026d727efdaf938c989c9a6a09bbce.png)

   2. 使用鼠标**左键长按并拖动分别选中**以下**区域**，**分别使用边框工具-下边框**

      ![image-20230424141531547](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_34dbb871cce52b7af3ac985e4db591c8.png)

   

4. **设置对齐**：

   1. **居中**、**居下**：使用鼠标**左键长按并拖动分别选中**以下红框**区域**，**分别使用水平对齐工具-居中对齐**，再使用**垂直对齐工具-底部对齐**

   2. **居右**、**居下**：使用鼠标**左键长按并拖动选中**以下蓝框**区域**，**使用水平对齐工具-右对齐**，再使用**垂直对齐工具-底部对齐**

      ![image-20230424141740725](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_2356be481926ea17b8294694c25a2341.png)

      ![image-20230424142538162](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_376419d0de6087b4075a188f668ac58e.png)

5. **字体设置**：

   1. 红框标题区域：**设置字体为18**
   2. 绿框内容部分：**设置字体为14**
   3. “逮捕令”：**设置加粗**

   ![image-20230424142111520](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_7a6307f4a108ee47f45b7e66d0e4a4f6.png)

   

6. **调整高度、宽度**：**分别拖动**以下两个区域中的横线和竖线调整对应单元格的宽度和高度

   ![image-20230424143040634](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_24cd04d61138ec899b815d90d1e50865.png)

#### 第二步：保存、预览

***



### 13. 抢修竣工单示例

#### **描述**

**基础数据报表**，固定数据表单，主要针对表样式的创建

#### 示例图

![image-20230504141212661](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_e17eb7bb094141e0013a84e5fbcc0114.png)

#### **第一步：**设计表格

1. **内容**：按以下样例添加表格内容

   ```
   供电公司抢修竣工单 填报单位： 北京电力公司 填报日期： 2017-12-11 填报名称： 20170420 项目编号： 2017-12-11
   项目批准核算 160万元 开工日期 2017-04-20 完工日期 201712-11 
   完工主要内容 北京站站工、#II主变保护更换为新型主变保护。
   形成能力 北京站#工、#I主变保护更换为新型主变保护，提高了变电运行安全可靠性。
   目标效益验收意见 北京站#工、#II主变保护更换为新型主变保护，提高了变电运行安全可靠性，技改成功。 2017-12-11
   实施质量验收评价 通过北京站#工、#工I主变保护更换为新型主变保护，提高了变电运行安全可靠性，技改质重良好。 2017-12-11
   验收总结 通过准坊站#工、工I主变保护更换为新型主变保护，提高了变电运行安全可靠性，技改成功。
   责任单位意见 通过潍坊站#工、#I主变保护更换为新型主变保护，提高了变电运行安全可靠性，技改成功。 
   责任单位审核人 赵六 日期 2017-12-11
   生技部审批意见 通过准坊站#工、#I主变保护更换为新型主变保护，提高了变电运行安全可掌性，技改成功。
   生技部主任 王五 日期 2017-12-11
   ```

   ![image-20230424143919222](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_5418759fa7fb5ad343768a9d917db0f8.png)

2. **合并单元格**：使用鼠标**左键长按并拖动分别选中**以下**区域**，**分别使用合并单元格工具**合并

   ![image-20230424144219056](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_6f5aabf01fe357b4d07308fde9e6ec4f.png)

3. **设置边框**：

   1. 使用鼠标**左键长按并拖动**选中以下**区域**，**使用边框工具-全部边框**

      ![image-20230424144427065](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_075c4dcc41809d195b2c36afaacc2cea.png)

   

4. **设置对齐**：

   1. **居中**：使用鼠标**左键长按并拖动选中**以下红框**区域**，**使用水平对齐工具-居中对齐**

   2. **居右**：使用鼠标**左键长按并拖动分别选中**以下蓝框**区域**，**分别使用水平对齐工具-右对齐**

      ![image-20230424144630064](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_981c1439049a66d86a91d9db244a0005.png)

      

5. **字体设置**：

   1. **红框**标题区域：**设置字体为18、加粗**

      ![image-20230424145204868](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_d240591ffe006526b742779f652d3888.png)

   2. **绿框**内容部分：**设置字体为10，不加粗**

      ![image-20230424145235487](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_f43f5166fa06fe421b64d89f7c98b5c1.png)

   3. **分别选中蓝框**内容部分：**设置加粗**

      ![image-20230424145427877](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_9831d8221218ad3da18bc20e8fbab635.png)

   

6. **调整高度、宽度**：**分别拖动**以下两个区域中的横线和竖线调整对应单元格的宽度和高度

   ![image-20230424145805514](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_4bf287d1af1d90509c2d0a6722343b00.png)

#### 第二步：保存、预览

***



### 14. 员工横向统计表示例（javabean）

#### **描述**

**横向数据报表**，数据横向、分组显示

* 如已**熟练**掌握**表格创建、数据集创建**，可**直接跳转第四步**

#### 示例图

![image-20230424160238829](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_25ed93b5ffaaebd4453e7727e65598ef.png)

#### 第一步：创建数据集（javabean）

1. **选择添加javabean数据集**

2. **填写唯一编码、名称**、**取消勾选是否分页**（详情见起步数据集介绍）

3. **填写javabean名称**，**UserReportJavaBeanDemo类的配置参见起步数据集介绍javabean数据集的配置**

   ![image-20230425154057614](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_54114c97b426b8cb9f794b536d4283da.png)

   ![image-20230504102202168](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_cf7e10e82c1d836a76735be2ff938937.png)

4. **设置性别字典code**，使报表能将存储的性别0、1转化为男、女：sys_user_sex，此值来源于数据字典，详情**见附录数据字典**

   ![image-20230425160357309](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_37d7cd5f5cc8709ed2116fbb84751f09.png)

#### 第二步：设计表格

1. **内容**：按以下样例输入表格内容

   ![image-20230424150954062](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_da176be63a5a85d26413416bdc78862b.png)

2. **合并单元格**：使用鼠标**左键长按并拖动**选中以下两个**区域**，使用**合并单元格工具合并**

   ![image-20230424151059450](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_1be560d94fae262723829e5492a0019c.png)

3. **设置对齐**：使用鼠标**左键长按并拖动分别选中**以下**区域**，使用**对齐工具-居中对齐**

   ![image-20230424151158913](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_a343b0e117e024805ebba9ac34db7cba.png)

4. **设置边框**：使用鼠标**左键长按并拖动**选中以下**区域**，使用**边框工具-全部边框**

   ![image-20230424151254644](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_cb67ddd825c3a46ad409e1bd07803fc3.png)

5. **填充背景色**：使用鼠标**左键长按并拖动**选中以下**区域**，使用 **填充工具-填充颜色**

   ![image-20230424151348305](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_3bcf8d319664a4498b29ff414679b0fc.png)

   

#### 第三步：添加数据

如下将**左侧数据集**中对应的数据使用鼠标左键**拖动**到**右侧表格**中对应位置即可

![image-20230424151644748](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_f39e9a155e4241d5a925f3c5873bfdd8.png)

#### 第四步：设置横向统计（重点）

选中如下红框数据区域，**鼠标右键-下滑找到-自定义横向分组-设定**

![image-20230424151524261](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_b452632d7e74a50596dc1015239eeabf.png)

#### 第五步：保存、预览

***



### 15. 核查评估表示例

#### **描述**

**基础数据报表**，固定数据表单，主要针对表样式的创建

#### 示例图

![image-20230424232625133](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_8d11c29d182f548d3a92597ff247fd21.png)

#### **第一步：**设计表格

1. **内容**：按以下样例添加表格内容

   ```
   XX县（市、区）YY低保第三方核查评估汇总表 三国村授珠社区 镇(乡、街道办事处) 村（社区）名称 户主名称 保障编号 家庭人口 家庭住址 联系电话 身份证号码 原保障 户数 人口 金额 核减后月人均收入 保障建议 保障类型 人口 差额补助 全额补助 增发补助 合计补助 是否新增对象 建议取消原因 收入超标  机动车超标 死亡 其他
   ```

   ![image-20230424230557689](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_915bea381453d9711d45648ea9f2b32f.png)

2. **合并单元格**：使用鼠标**左键长按并拖动分别选中**以下**区域**，**分别选中合并单元格工具**合并

   ![image-20230424230742438](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_f2039c84068dcbfec8e2d014d0042c60.png)

3. **设置边框**：

   1. 使用鼠标**左键长按并拖动**选中以下**区域**，使用**边框工具-全部边框**

      ![image-20230424230840321](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_db2c986ad7ff37c3da3c1e52113fb8ab.png)

   2. 使用鼠标**左键长按并拖动**选中以下**区域**，使用**边框工具-下边框**

      ![image-20230424230921220](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_6e637ca31b9b19999d217e1e807e7062.png)

   

4. **设置对齐**：

   1. **居中**：使用鼠标**左键长按并拖动分别选中**以下红框**区域**，**分别使用水平对齐工具-居中对齐**

      ![image-20230424231041318](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_bf2db81e1360920c44f6db28aeae0ed2.png)

      

5. **字体设置**：

   1. **红框**标题区域：**设置字体为15、加粗**

      ![image-20230424231204809](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_eef9d9a97a016631f55b9321415e22f4.png)

   2. **绿框**内容部分：**设置字体颜色**

      ![image-20230424231317843](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_59957a333b82a069414c22f3a9a876f7.png)

   

6. **设置背景色**

   1. 选择红框区域，使用填充工具填充颜色

      ![image-20230424231529688](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_261cb58508c98867a0c441db816acf10.png)

7. **调整高度、宽度**：**分别拖动**以下两个区域中的横线和竖线调整对应单元格的宽度和高度

   ![image-20230504143653673](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_8a5ec5ab198cd12bc72760d95f4bd043.png)

#### 第二步：添加数据

1. 如图添加数据

   ![image-20230424232132704](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_f79dde6244f697a4cbf25dac97b738de.png)

#### 第三步：保存、预览

***



### 16. 员工信息登记表示例

#### **描述**

**基础数据报表**，固定数据表单，主要针对表样式的创建

#### 示例图

![image-20230424155557219](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_07d0f648c500051f7f2c86d69f9746e7.png)

#### **第一步：**设计表格

1. **内容**：按以下样例添加表格内容

   ```
   员工信息登记表 编号 002 填写日期：2021年01月27日  姓名：马飞 性别：男 出生年月： 1998/09/08 民族：汉族 政治面貌：群众 籍贯：江苏 身高： 185 体重：75 健康状况：良好 身份证号： 320525198909089999 学历：本科 照片 毕业学校：苏州科技大学 专业：计算机 联系地址：江苏省苏州市 邮编：215200 邮箱:8888888@qq.com 手机号：188888888 外语语种：英语 外语水平：六级  计算机水平：三级 毕业时间：2021年7月1日 到职时间： 2021年9月7日 职称： 初级程序员 教育经历：2017年9月－2021年7月，在苏州科技大学攻读计算机专业，获得学士学位工作经历： 
   ```

   ![image-20230424153602377](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_0d86654242c4dc8151149adaaef8c395.png)

2. **合并单元格**：使用鼠标**左键长按并拖动分别选中**以下**区域**，**分别使用合并单元格工具**合并

   ![image-20230424153953429](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_c9bb452b0859d1696b9588939135c9c0.png)

3. **设置边框**：使用鼠标**左键长按并拖动**选中以下**区域**，使用**边框工具-所有边框**

   ![image-20230424154136110](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_a82fe521fd6f7f3722186aee66066d81.png)

4. **设置对齐**：

   1. **居中**：使用鼠标**左键长按并拖动分别选中**以下红框**区域**，**分别使用对齐工具-居中对齐**
   2. **居右**：使用鼠标**左键长按并拖动分别选中**以下蓝框**区域**，**分别使用对齐工具-右对齐**

   ![image-20230424155258615](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_246ec1dcaf1201e5805b6c53ff7ed9fb.png)

5. **字体设置**：

   1. 选择如下标题区域：**设置字体为16**，**加粗**

      ![image-20230424154837559](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_25a3269e0826fc3081bd71f8277d39af.png)

   2. 如下蓝框内容部分：**分别使用设置字体为10，加粗**

      ![image-20230424155036540](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_176e5903ea3560b2adf223568c1a150a.png)

   

6. **调整高度、宽度**：**分别拖动**以下两个区域中的横线和竖线调整对应单元格的宽度和高度

   ![image-20230424155511508](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_cf40051cb3750f187e5d5851e8ce5a9b.png)

#### 第二步：保存、预览

------



## 图形报表

### 数据库表

1. 示例依赖该数据表：report_demo_income.sql：用于**交叉报表、分组小计报表**、**图形报表**示例数据

### 基本图表示例

#### 示例图

![image-20230509163628680](报表示例V5_Img/image-20230509163628680.png)

#### 具体示例

**点击插入图表工具，在弹出框中选择所需图表，即可插入到设计器中**

![image-20230508162509663](报表示例V5_Img/image-20230508162509663.png)

![image-20230508162646785](报表示例V5_Img/image-20230508162646785.png)

##### 通用配置（可跳过）

###### 样式-背景设置

设置图表的背景颜色

1. **点击选中图表**，最好是点击图表中的文字或者图形，空白处点击可能无法选中图表，选中图表后右侧属性栏会出现样式属性设置
2. 样式属性设置中选择背景设置，**打开“启用背景”开关**
3. **选择背景颜色**
4. **不需要背景**时直接**关闭“启用背景”**开关即可

![image-20230508163438404](报表示例V5_Img/image-20230508163438404.png)

###### 样式-边距设置

设置图表内容与四个边缘的距离

![image-20230509091517357](报表示例V5_Img/image-20230509091517357.png)

###### 样式-提示语设置

设置鼠标悬停在图上时的提示信息

![image-20230509091739291](报表示例V5_Img/image-20230509091739291.png)

###### 样式-数值设置

设置是否显示对应的y轴数据

![image-20230509091907449](报表示例V5_Img/image-20230509091907449.png)

###### 样式-标题设置

设置图表的标题、标题字体样式、标题位置，标题边距

![image-20230509092119611](报表示例V5_Img/image-20230509092119611.png)

###### 样式-主体设置

设置主体的宽度、圆角、高度、颜色

![image-20230509092310304](报表示例V5_Img/image-20230509092310304.png)

###### 样式-图例设置

**（仅多数据对比柱形图、堆叠柱形图有）**

![image-20230509092618916](报表示例V5_Img/image-20230509092618916.png)

###### 样式-X、Y轴设置

![image-20230509092814493](报表示例V5_Img/image-20230509092814493.png)

![image-20230509092832315](报表示例V5_Img/image-20230509092832315.png)

###### 样式-自定义配色

**（仅多数据对比柱形图、堆叠柱形图有）**：暂时存在问题，无法设置

###### 数据-定时刷新

对于sql数据集、api数据集的动态数据，可以配置定时刷新功能，指定时间后自动获取新数据

![image-20230508170816744](报表示例V5_Img/image-20230508170816744.png)

![image-20230508170843115](报表示例V5_Img/image-20230508170843115.png)

###### 

***



##### 1. 普通柱形图

###### 描述：

所有数据根据x轴和y轴对应关系显示，鼠标放上去显示具体数据

###### 示例图：用户-年龄数据

![image-20230509100615345](报表示例V5_Img/image-20230509100615345.png)

###### 第一步：创建数据集(详情见起步数据集介绍)

1. **选择添加sql数据集**

2. **左侧点击向右的箭头**

   ![image-20230509135934947](报表示例V5_Img/image-20230509135934947.png)

3. **选择数据库**

4. **选择数据表（以sys_user为例）**

5. **填写唯一编码、名称**、**取消勾选是否分页**（详细参考起步数据集具体介绍）

6. **报表sql**：

   ```sql
   select *  from sys_user
   ```

   ![image-20230421094233615](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_568b88d8a077b6f797aa44ec8bda9689.png)

   ![image-20230509140226448](报表示例V5_Img/image-20230509140226448.png)

###### 第一步：选择图表

1. 选择一个单元格，作为**图表的左上角**位置，并**点击图表工具**

   ![image-20230425012118350](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_5f5d15154a3a6cfbd4f3edf3602765a7.png)

2. 选择**普通柱形图**图表，插入到表格中

   ![image-20230425012153845](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_2aa65e065b0454077053d9e7dbffcacd.png)

###### 第二步：配置图表数据

1. **数据如下图选择**

2. **分类属性**：x轴数据，此处使用用户名称user_name

3. **值属性**：y轴数据，此处使用用户年龄age

   ![image-20230509100148564](报表示例V5_Img/image-20230509100148564.png)

###### 第三步：配置图表样式

1. **设置标题**：用户-年龄

   ![image-20230509100236904](报表示例V5_Img/image-20230509100236904.png)

2. **x轴设置**：

   1. 设置名称：姓名

   2. 设置角度：50


   ![image-20230509100415124](报表示例V5_Img/image-20230509100415124.png)

3. **y轴设置**：设置名称为：年龄

   ![image-20230509100451849](报表示例V5_Img/image-20230509100451849.png)

4. **柱体宽度设置为：0**，根据需要设置为合适的，此处设置为0自适应

   ![image-20230509100527369](报表示例V5_Img/image-20230509100527369.png)

   

   

***



##### 2. 多数据对比柱状图

###### 描述：

显示每个分类下的多个子类的数据，例如安徽省（x轴分类）一月、二月（x轴子类）的收入数据（y轴数据）

###### 示例图：

![image-20230509102908433](报表示例V5_Img/image-20230509102908433.png)

###### 第一步：创建数据集(详情见起步数据集介绍)

1. **选择添加sql数据集**

2. **左侧点击向右的箭头**

   ![image-20230509135934947](报表示例V5_Img/image-20230509135934947.png)

3. **选择数据库**

4. **选择数据表（以report_demo_income为例）**

5. **填写唯一编码、名称**、**取消勾选是否分页**（详细参考起步数据集具体介绍）

6. **报表sql**：此处以**华东地区2021年一月、二月数据**为例

   ```sql
   select 
   *
   from 
   report_demo_income
   where 
   region = '华东' 
   and 
   `year` = '2021'
   and 
   `month` in ('01' ,'02')
   ```

   ![image-20230421094233615](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_568b88d8a077b6f797aa44ec8bda9689.png)

   ![image-20230509101529872](报表示例V5_Img/image-20230509101529872.png)

###### 第二步：选择图表

1. 选择一个单元格，作为**图表的左上角**位置，并**点击图表工具**

   ![image-20230425092505499](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_de4fe87261df3e1f4940227098d02c85.png)

2. 选择**多数据对比柱状图**图表，插入到表格中

###### 第三步：配置图表数据

1. **数据如下图选择**

2. **分类属性**：即x轴的数据，省份

3. **值属性**：y轴数据，主要收入

4. **系列属性**：x轴数据下的子分类，此处设置为省份的月份

   设置后的意思：如下图有：安徽省的两个月的收入数据

   ![image-20230509101805074](报表示例V5_Img/image-20230509101805074.png)

###### 第四步：配置图表样式

1. **标题**

   * **文字**：2021年华东地区省份一月、二月收入数据

   * **顶边距**：0

![image-20230509102358097](报表示例V5_Img/image-20230509102358097.png)

2. **y轴设置**
   * **名称**：收入


![image-20230509102633718](报表示例V5_Img/image-20230509102633718.png)

3. **x轴设置**
   * **名称**：省份-月


![image-20230509102540434](报表示例V5_Img/image-20230509102540434.png)

***



##### 3. 正负条形图

###### 描述

显示正负数值比对数据

###### 示例图

![image-20230509113535953](报表示例V5_Img/image-20230509113535953.png)

###### 第一步：创建数据集(详情见起步数据集介绍)

1. **选择添加sql数据集**

2. **左侧点击向右的箭头**

   ![image-20230509135934947](报表示例V5_Img/image-20230509135934947.png)

3. **选择数据库**

4. **选择数据表（以report_demo_income为例）**

5. **填写唯一编码、名称**、**取消勾选是否分页**（详细参考起步数据集具体介绍）

6. **报表sql**：此处以**华东地区各省份2021年一月收入、支出、利润数据**为例

   ```sql
   select 
   rdi1.province ,rdi1.main_income value,"收入" as type from report_demo_income rdi1
   where `year` = '2021'and region = '华东'and `month` ='01'
   union 
   select 
   rdi2.province ,rdi2.other_income value,"支出" as type from report_demo_income rdi2
   where `year` = '2021'and region = '华东'and `month` ='01'
   union 
   select 
   rdi3.province ,rdi3.all_income  value,"利润" as type from report_demo_income rdi3
   where `year` = '2021'and region = '华东'and `month` ='01'
   ```

   ![image-20230509112308030](报表示例V5_Img/image-20230509112308030.png)

   ![image-20230421094233615](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_568b88d8a077b6f797aa44ec8bda9689.png)

   ![image-20230509105806512](报表示例V5_Img/image-20230509105806512.png)

###### 第二步：选择图表

1. 选择一个单元格，作为**图表的左上角**位置，并**点击图表工具**

   ![image-20230425101714658](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_e6ff82c61be47c1d437518cf1c88e8b6.png)

2. 选择**正负条形图**图表，插入到表格中

###### 第三步：配置图表数据

1. **数据如下图选择**

2. **分类属性**：即x轴的数据，省份

3. **值属性**：y轴数据，值

4. **系列属性**：type：type值有三个收入、支出、利润，因此每个省份下有三个值

   ![image-20230509112939325](报表示例V5_Img/image-20230509112939325.png)

###### 第二步：配置图表样式

1. **设置标题**：

   * **文字**：2021年一月份各省份收入支出利润
   * **顶边距**：0px

   ![image-20230509113101346](报表示例V5_Img/image-20230509113101346.png)

   

***



##### 4. 堆叠柱形图

###### 描述

可将需要显示在一起的数据堆叠在一起

###### 示例图

![image-20230509115200702](报表示例V5_Img/image-20230509115200702.png)

###### 第一步：创建数据集(详情见起步数据集介绍)

1. **选择添加sql数据集**

2. **左侧点击向右的箭头**

   ![image-20230509135934947](报表示例V5_Img/image-20230509135934947.png)

3. **选择数据库**

4. **选择数据表（以report_demo_income为例）**

5. **填写唯一编码、名称**、**取消勾选是否分页**（详细参考起步数据集具体介绍）

6. **报表sql**：此处以**华东地区各省份2021年一月收入、支出、利润数据**为例

   ```sql
   select 
   rdi1.province ,rdi1.main_income value,"收入" as type from report_demo_income rdi1
   where `year` = '2021'and region = '华东'and `month` ='01'
   union 
   select 
   rdi2.province ,rdi2.other_income value,"支出" as type from report_demo_income rdi2
   where `year` = '2021'and region = '华东'and `month` ='01'
   union 
   select 
   rdi3.province ,rdi3.all_income  value,"利润" as type from report_demo_income rdi3
   where `year` = '2021'and region = '华东'and `month` ='01'
   ```

   ![image-20230509112308030](报表示例V5_Img/image-20230509112308030.png)

   ![image-20230421094233615](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_568b88d8a077b6f797aa44ec8bda9689.png)

   ![image-20230509105806512](报表示例V5_Img/image-20230509105806512.png)

###### 第二步：选择图表

1. 选择一个单元格，作为**图表的左上角**位置，并**点击图表工具**

   ![image-20230425103210647](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_f79fea7bcfede76d14ffd3e1c608b883.png)

2. 选择**堆叠柱形图**图表，插入到表格中

   ![image-20230425104422627](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_045cdf18963738b50ce876750c1a06a5.png)

1. ###### 第三步：配置图表数据

   1. **数据如下图选择**

   2. **分类属性**：即x轴的数据，省份

   3. **值属性**：y轴数据，值

   4. **系列属性**：type：type值有三个收入、支出、利润，因此每个省份下有三个值

      ![image-20230509114009621](报表示例V5_Img/image-20230509114009621.png)

###### 第二步：配置图表样式

* **设置标题**：

  * **文字**：2021年一月份各省份收入支出利润
  * **顶边距**：0px

  ![image-20230509115727124](报表示例V5_Img/image-20230509115727124.png)

* **x轴设置**：名称：省份

  ![image-20230509115752490](报表示例V5_Img/image-20230509115752490.png)



###### 第四步：设置堆叠

情景：按上述设置好后，每个省份有三个值，收入、支出、利润，现在要将收入、支出放在一起，利润单独放置，以便观察

1. **点击系列类型下的新增**：

   1. **系列**：可选值有收入、支出、利润，需要依次设置

   2. **系列堆叠值**：相同系列堆叠值的会堆叠在一起

      ![image-20230509115014514](报表示例V5_Img/image-20230509115014514.png)

   3. 要将**收入支出堆叠**在一起显示，就依次新增收入和支出的系列类型，将他们的**系列堆叠值**设置为相同，如下都**设置为1**

      ![image-20230509114825389](报表示例V5_Img/image-20230509114825389.png)

      ![image-20230509114910410](报表示例V5_Img/image-20230509114910410.png)


***



##### 5. 多数据条形柱状图

###### 描述

显示每个分类下的多个子类的数据，例如安徽省（x轴分类）一月、二月（x轴子类）的收入数据（y轴数据）

###### 示例图

![image-20230509115934981](报表示例V5_Img/image-20230509115934981.png)

###### 设计

**参考多数据对比柱状图**：x轴和y轴设置交换即可

![image-20230425111338901](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_fb4256eb55bd3b69b90fae413d3670ec.png)

***



##### 6. 多数据对比折线图

###### 描述

折线图，描述多个数据的对比信息

###### 示例图

![image-20230509135134223](报表示例V5_Img/image-20230509135134223.png)

###### 第一步：创建数据集(详情见起步数据集介绍)

1. **选择添加sql数据集**

2. **左侧点击向右的箭头**

   ![image-20230509135934947](报表示例V5_Img/image-20230509135934947.png)

3. **选择数据库**

4. **选择数据表（以report_demo_income为例）**

5. **填写唯一编码、名称**、**取消勾选是否分页**（详细参考起步数据集具体介绍）

6. **报表sql**：此处以**四川省2021-2023年每个月的收入数据**为例

   ```sql
   select *  from report_demo_income where province='四川'
   ```

   ![image-20230421094233615](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_568b88d8a077b6f797aa44ec8bda9689.png)

   ![image-20230509133955943](报表示例V5_Img/image-20230509133955943.png)

###### 第二步：选择图表

1. 选择一个单元格，作为**图表的左上角**位置，并**点击图表工具**

   ![image-20230425112141628](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_5667a1c8b7118270208c617b5481a1f6.png)

2. 选择**多数据对比折线图**图表，插入到表格中

   ![image-20230425112121593](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_79bdfc070ea7b36c14c06dc93741e59c.png)

###### 第三步：配置图表数据

1. **数据如下图选择**

2. **分类属性**：x轴数据，此处使用12个月作为x轴数据

3. **值属性**：y轴数据，此处使用收入作为y轴数据

4. **系列属性**：x轴的子分类，此处的每个月份都存在2021、2022、2023三个子类

   ![image-20230509134302442](报表示例V5_Img/image-20230509134302442.png)

###### 第四步：配置图表样式

1. **设置标题**：

   1. **文字**：四川省2021-2023每月主要收入数据对比

   2. **顶边距**：0px


   ![image-20230509134429825](报表示例V5_Img/image-20230509134429825.png)

2. **x轴设置**：设置名称为月份

   ![image-20230509134642250](报表示例V5_Img/image-20230509134642250.png)

3. **y轴设置**：设置名称为收入

   ![image-20230509135054838](报表示例V5_Img/image-20230509135054838.png)

4. **关闭数值显示**：此例开启会导致显示重叠，不好看，因此关闭

   ![image-20230509134948203](报表示例V5_Img/image-20230509134948203.png)

***



##### 7. 饼图

###### 描述

使用饼图更清晰的比较各数据之间的大小（占比）

###### 示例图

![image-20230509141521631](报表示例V5_Img/image-20230509141521631.png)

###### 第一步：创建数据集(详情见起步数据集介绍)

1. **选择添加sql数据集**

2. **左侧点击向右的箭头**

   ![image-20230509135934947](报表示例V5_Img/image-20230509135934947.png)

3. **选择数据库**

4. **选择数据表（以report_demo_income为例）**

5. **填写唯一编码、名称**、**取消勾选是否分页**（详细参考起步数据集具体介绍）

6. **报表sql**：此处以**华东地区各省份2021年一月的收入数据**为例

   ```sql
   select *  from report_demo_income where region ='华东' and year = '2021' and `month` ='01'
   ```

   ![image-20230421094233615](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_568b88d8a077b6f797aa44ec8bda9689.png)

   ![image-20230509135711650](报表示例V5_Img/image-20230509135711650.png)

###### 第二步：选择图表

1. 选择一个单元格，作为**图表的左上角**位置，并**点击图表工具**

   ![image-20230425112725344](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_3d9c27ae0b70f58f241ff7872a355025.png)

2. 选择**饼图**图表，插入到表格中

   ![image-20230425112708885](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_ebe4c25c555820b37e1047808b3f8d64.png)

###### 第三步：配置图表数据

1. **数据如下图选择**

2. **分类属性**：图中每个区域，此例使用的是省份数据作为分类，因此填入province

3. **值属性**：图中每个区域对应的数据值，此例代表的是主要收入值，因此填入main_income

![image-20230509140838532](报表示例V5_Img/image-20230509140838532.png)

###### 第四步：配置图表样式

1. **设置标题**

   * **文字**：华东地区各省份2021年一月的收入数据
   * **顶边距**：0px

   ![image-20230509141242969](报表示例V5_Img/image-20230509141242969.png)



***



##### 8. 南丁格尔玫瑰饼图

###### 描述

饼图的另一表现形式，对不同的值以不同区域、不同大小显示

###### 示例图

![image-20230509141926495](报表示例V5_Img/image-20230509141926495.png)

###### 第一步：选择图表

1. 选择一个单元格，作为**图表的左上角**位置，并**点击图表工具**

   ![image-20230425114520152](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_bd7539e5624f08b458875ac3110a4040.png)

2. 选择**南丁格尔玫瑰饼图**图表，插入到表格中

   ![image-20230425114641632](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_7d6c8cb8ac28fa74b2acf636f73671b4.png)

###### 第二步：配置图表

完全参考饼图即可



***



##### 9. 普通散点图

###### 描述

散点图在报表中通常被用来展示**两个数值型变量之间的关系**，例如**相关性或趋势**。通过将每个数据点绘制成一个散点，可以清晰地展示出这两个变量之间的分布规律和趋势。

###### 示例图

![image-20230509143700043](报表示例V5_Img/image-20230509143700043.png)

###### 第一步：创建数据集(详情见起步数据集介绍)

1. **选择添加sql数据集**

2. **左侧点击向右的箭头**

   ![image-20230509135934947](报表示例V5_Img/image-20230509135934947.png)

3. **选择数据库**

4. **选择数据表（以report_demo_income为例）**

5. **填写唯一编码、名称**、**取消勾选是否分页**（详细参考起步数据集具体介绍）

6. **报表sql**：此处以**上海2021年12个月的主要收入数据**为例

   ```sql
   select *  from report_demo_income
   where province ='上海'
   and year = '2021'
   ```

   ![image-20230421094233615](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_568b88d8a077b6f797aa44ec8bda9689.png)

   ![image-20230509142412912](报表示例V5_Img/image-20230509142412912.png)

###### 第二步：选择图表

1. 选择一个单元格，作为**图表的左上角**位置，并**点击图表工具**

   ![image-20230425114901682](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_69133bb6bb8792fef2c86743ea3ac27a.png)

2. 选择**普通散点图**图表，插入到表格中

   ![image-20230425115021530](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_5ea9e22a417049b9f97b99b435b88723.png)

###### 第三步：配置图表数据

**注：散点图x轴只支持数字类型**

1. **数据如下图选择**

2. **分类属性**：x轴数据，此处选择月份作为x轴数据

3. **值属性**：y轴数据，此处使用月分对应的主要收入作为y轴数据

   ![image-20230509142923955](报表示例V5_Img/image-20230509142923955.png)

###### 第四步：配置图表样式

1. **标题设置**

   * **文字**：**上海2021年12个月的主要收入数据**

   * **顶边距**：0px

     ![image-20230509143055276](报表示例V5_Img/image-20230509143055276.png)

2. **x轴设置**：

   * 名称：月份

     ![image-20230509143619368](报表示例V5_Img/image-20230509143619368.png)

***



##### 10. 气泡散点图

###### 描述

气泡散点图在报表中通常被用来展示**多个分类**下的**两个数值型变量之间的关系**，例如**相关性或趋势**。如显示2021-2023三年的每年12个月的收入数据趋势

###### 示例图

![image-20230509145229359](报表示例V5_Img/image-20230509145229359.png)

###### 第一步：创建数据集(详情见起步数据集介绍)

1. **选择添加sql数据集**

2. **左侧点击向右的箭头**

   ![image-20230509135934947](报表示例V5_Img/image-20230509135934947.png)

3. **选择数据库**

4. **选择数据表（以report_demo_income为例）**

5. **填写唯一编码、名称**、**取消勾选是否分页**（详细参考起步数据集具体介绍）

6. **报表sql**：此处以**上海2021-2023年12个月的主要收入数据**为例

   ```sql
   select *  from report_demo_income
   where province ='上海'
   ```

   ![image-20230421094233615](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_568b88d8a077b6f797aa44ec8bda9689.png)

   ![image-20230509144051709](报表示例V5_Img/image-20230509144051709.png)

###### 第二步：选择图表

1. 选择一个单元格，作为**图表的左上角**位置，并**点击图表工具**

   ![image-20230425150144733](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_bbb6f7b608cfd1acbe2de7c803231ba1.png)

2. 选择**气泡散点图**图表，插入到表格中

###### 第三步：配置图表数据

散点图**x轴只支持数字类型**

1. **数据如下图选择**

2. **分类属性**：x轴数据，此处以月份作为x轴数据

3. **值属性**：y轴数据，此处使用月份对应的主要收入作为y轴数据

4. **系列属性**：x轴分类的子分类，此处以年份作为该值，表示一月份对应的2021年、2022年、2023年

   ![image-20230509144215620](报表示例V5_Img/image-20230509144215620.png)

###### 第四步：配置图表样式

1. **标题设置**：

   * **文字**：上海2021-2023年12个月的主要收入数据

   * **顶边距**：0px

     ![image-20230509144949065](报表示例V5_Img/image-20230509144949065.png)

2. **x轴设置**：

   * **文字**：月份

     ![image-20230509145058124](报表示例V5_Img/image-20230509145058124.png)

3. y轴设置：

   * **文字**：收入

     ![image-20230509145150822](报表示例V5_Img/image-20230509145150822.png)

***



##### 11. 普通折柱图

###### 描述

折柱图（也称为组合图）在报表中通常用于同时展示两个或多个数据系列，一般通过在同一坐标系中绘制折线图和柱状图来实现。

折线图通常用来展示数据随时间或其他变量的变化趋势，而柱状图则用于展示数据之间的比较关系。通过将这两种图表结合在一起，折柱图可以同时展示数据的趋势和比较信息，从而更全面地展现数据的特征。

###### 示例图

![image-20230509153639227](报表示例V5_Img/image-20230509153639227.png)

###### 第一步：创建数据集(详情见起步数据集介绍)

1. **选择添加sql数据集**

2. **左侧点击向右的箭头**

   ![image-20230509135934947](报表示例V5_Img/image-20230509135934947.png)

3. **选择数据库**

4. **选择数据表（以report_demo_income为例）**

5. **填写唯一编码、名称**、**取消勾选是否分页**（详细参考起步数据集具体介绍）

6. **报表sql**：此处以**四川省2021年每个月的收入、支出、利润数据**为例

   ```sql
   select 
   rdi1.month,rdi1.main_income value,"收入" as type from report_demo_income rdi1
   where `year` = '2021'and province = '四川'
   union 
   select 
   rdi2.month ,rdi2.other_income value,"支出" as type from report_demo_income rdi2
   where `year` = '2021'and province = '四川'
   union 
   select 
   rdi3.month ,rdi3.all_income  value,"利润" as type from report_demo_income rdi3
   where `year` = '2021'and province = '四川'
   ```

   ![image-20230509151404299](报表示例V5_Img/image-20230509151404299.png)

   ![image-20230421094233615](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_568b88d8a077b6f797aa44ec8bda9689.png)

   ![image-20230509150315437](报表示例V5_Img/image-20230509150315437.png)

###### 第二步：选择图表

1. 选择一个单元格，作为**图表的左上角**位置，并**点击图表工具**

   ![image-20230425115427022](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_80cbdc7940d425a9e368a266bd4dded3.png)

2. 选择**普通折柱图**图表，插入到表格中

   ![image-20230509151138990](报表示例V5_Img/image-20230509151138990.png)

###### 第三步：配置图表数据

1. **数据如下图选择，与获取的数据集数据对照**

2. **分类属性**：x轴数据，此处使用12个月月份作为x轴数据

3. **系列属性**：x轴的子分类，type的值，即收入、支出、利润，表示每个月都有收入、支出、利润分类

4. **值属性**：y轴数据，收入、支出、利润的对应值

   ![image-20230509151237790](报表示例V5_Img/image-20230509151237790.png)

   ![image-20230509151419502](报表示例V5_Img/image-20230509151419502.png)

###### 第四步：配置图表样式

1. **设置标题**：

   * **文字**：四川省2021年每个月的收入、支出、利润数据

   * **顶边距**：0px

     ![image-20230509150434271](报表示例V5_Img/image-20230509150434271.png)

2. **x轴设置**：

   * **设置名称**：月份

   ![image-20230509150656988](报表示例V5_Img/image-20230509150656988.png)

3. **左y轴设置**：

   * **设置名称**：收入

     ![image-20230509150759807](报表示例V5_Img/image-20230509150759807.png)

4. **右y轴设置**

   * **设置名称**：支出

     ![image-20230509151035369](报表示例V5_Img/image-20230509151035369.png)

4. 

###### 第五步：配置折柱

**配置系列类型**：新增系列类型，将利润数据设置为折线，效果如下

![image-20230509153601656](报表示例V5_Img/image-20230509153601656.png)



***



##### 12. 金字塔漏斗图

###### 描述

金字塔漏斗图是一种特殊的漏斗图，它可以在报表中**直观地呈现数据的层次结构和比例关系**。在金字塔漏斗图中，数据会从上方的大面积逐级缩小，最终汇聚到底部的小面积中，从而形成一个类似于金字塔形状的图表。

###### 示例图

![image-20230509154642010](报表示例V5_Img/image-20230509154642010.png)

###### 第一步：创建数据集(详情见起步数据集介绍)

1. **选择添加sql数据集**

2. **左侧点击向右的箭头**

   ![image-20230509135934947](报表示例V5_Img/image-20230509135934947.png)

3. **选择数据库**

4. **选择数据表（以report_demo_income为例）**

5. **填写唯一编码、名称**、**取消勾选是否分页**（详细参考起步数据集具体介绍）

6. **报表sql**：此处以**华东地区各省份2021年一月的收入数据**为例

   ```sql
   select *  from report_demo_income where region ='华东' and year = '2021' and `month` ='01'
   ```

   ![image-20230421094233615](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_568b88d8a077b6f797aa44ec8bda9689.png)

   ![image-20230509154128163](报表示例V5_Img/image-20230509154128163.png)

###### 第二步：选择图表

1. 选择一个单元格，作为**图表的左上角**位置，并**点击图表工具**

   ![image-20230425133756796](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_94a1ba7e73caaff7e7f2a9bf0dace522.png)

2. 选择**金字塔漏斗图**图表，插入到表格中

   ![image-20230425133823930](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_4543a017b8a7c7e872048b5108e8a1cc.png)

###### 第三步：配置图表数据

1. **数据如下图选择**

2. **分类属性**：金字塔层次分类数据，此处使用省份作为该分类

3. **值属性**：每层的具体数据值，此处使用省份一月份主要收入作为该值

   ![image-20230509154351994](报表示例V5_Img/image-20230509154351994.png)

###### 第四步：配置图表样式

1. **设置标题**：

   * **文字**：华东地区各省份2021年一月的收入数据
   * **顶边距**：0px
   
   ![image-20230509154544405](报表示例V5_Img/image-20230509154544405.png)



***



##### 13. 360°仪表盘图

###### 描述

仪表盘图通常用于**显示某些指标或关键绩效指标（KPI）的状态或趋势**。它通过模拟传统机械仪表盘的视觉样式和行为，将数据可视化为一个圆形或半圆形的盘面，并在盘面上标识出各种指标的范围、位置、大小、颜色等，**以便用户能够快速地了解数据的状态、趋势和变化。**

###### 示例图

![image-20230509155904481](报表示例V5_Img/image-20230509155904481.png)

###### 第一步：创建数据集(详情见起步数据集介绍)

1. **选择添加sql数据集**

2. **左侧点击向右的箭头**

   ![image-20230509135934947](报表示例V5_Img/image-20230509135934947.png)

3. **选择数据库**

4. **选择数据表（以report_demo_income为例）**

5. **填写唯一编码、名称**、**取消勾选是否分页**（详细参考起步数据集具体介绍）

6. **报表sql**：此处以**最新的一条监控数据**为例

   ```sql
   SELECT * FROM am_metric ORDER BY created_at DESC LIMIT 1;
   ```

   ![image-20230421094233615](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_568b88d8a077b6f797aa44ec8bda9689.png)

   ![image-20230509155247112](报表示例V5_Img/image-20230509155247112.png)

###### 第二步：选择图表

1. 选择一个单元格，作为**图表的左上角**位置，并**点击图表工具**

   ![image-20230425134919529](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_8b43628a164b030ba5bf3a78ab6dee35.png)

2. 选择**360°仪表盘图**图表，插入到表格中

###### 第三步：配置图表数据

1. **数据如下图选择**

2. **分类属性**：仪表盘名称，此处是监控的项目

3. **值属性**：仪表盘数据，显示的百分比数值

   ![image-20230509155627046](报表示例V5_Img/image-20230509155627046.png)

###### 第四步：配置图表样式

1. **设置标题**：监控数据

   ![image-20230509155839886](报表示例V5_Img/image-20230509155839886.png)



***



##### 14. 关系图

###### 描述

关系图是一种用于**展示数据之间相互关联关系的可视化图表**。它通过图形化的方式将数据元素和它们之间的关系表示出来，使得用户可以更加**直观地了解数据之间的关联关系，从而更好地进行数据分析和决策。**

###### 示例图

![image-20230509163422673](报表示例V5_Img/image-20230509163422673.png)

###### 第一步：创建数据集(详情见起步数据集介绍)

1. **选择添加sql数据集**

2. **左侧点击向右的箭头**

   ![image-20230509135934947](报表示例V5_Img/image-20230509135934947.png)

3. **选择数据库**

4. **选择数据表（以report_demo_income为例）**

5. **填写唯一编码、名称**、**取消勾选是否分页**（详细参考起步数据集具体介绍）

6. **报表sql**：此处以**部门关系数据**为例

   ```sql
   select *  from sys_dept where dept_tree_code = 'defaultTree'
   ```

   ![image-20230421094233615](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_568b88d8a077b6f797aa44ec8bda9689.png)

   ![image-20230509161803255](报表示例V5_Img/image-20230509161803255.png)

###### 第二步：选择图表

1. 选择一个单元格，作为**图表的左上角**位置，并**点击图表工具**

   ![image-20230425140347005](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_9daa968ecdcfd9161d3da64ed546f744.png)

2. 选择**关系图**图表，插入到表格中

   ![image-20230425140402288](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_3970609df320e2b2b82964d98920daf6.png)

###### 第三步：配置图表数据

部门表自身存在上下级关系，因此图表数据直接使用部门表数据，关系根据部门表的父id确定

1. **数据如下图选择**：

2. **分类属性**：部门id

3. **值属性**：此处使用部门名字

4. **系列属性**：此处使用部门名字

5. **来源属性、关联属性**：部门父id和部门id，可以表明部门之间的上下级关系，来源指向目标及父部门指向子部门

   ![image-20230509162239931](报表示例V5_Img/image-20230509162239931.png)

###### 第二步：配置图表样式

1. **标题设置**

   * **文字**：部门关系

   * **顶边距**：0px

     ![image-20230509162726300](报表示例V5_Img/image-20230509162726300.png)

2. **数值显示**

   * 开启数值显示

     ![image-20230509162814757](报表示例V5_Img/image-20230509162814757.png)

3. **图例设置**：

   * **横向位置**：左对齐

   * **布局朝向**：竖排

   * **上边距**：50

     ![image-20230509163102647](报表示例V5_Img/image-20230509163102647.png)

4. **中心点位置**：

   * 设置宽高：将图形置于中间位置

     ![image-20230509163330668](报表示例V5_Img/image-20230509163330668.png)

# 附录

## 数据字典

### 配置

#### **第一步：配置入口**：

* **入口一**：首页菜单报表管理

  ![image-20230504171516273](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_07ec14d013168bb3e59258c1514ca262.png)

* **入口二**：设计器中左侧栏，点击笔，弹出界面同入口一

  ![image-20230504171818857](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_fba0b18f4b5c08882d516cc9b5158f61.png)

#### 第二步：新增字典

- 字典名称：给字典起个名字，中英文、数字都可以；
- 字典编码：字典的编码名称，最好是英文，简单好识别的；
- 描述：简单介绍一下这个字段的用途，方便后期或团队协助查看；

![image-20230504172112101](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_fb4973ebeb4aba0f04d74426350793b8.png)

#### 第三步：字典配置

1. 点击字典配置按钮

   ![image-20230504172207965](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_65bb93259dbdea5ce00fb16abf86cb4d.png)

2. 配置具体的字典值

   1. 名称：字典解析后显示的名称；

   2. 数据值：字典需要把数据库或API中的那些值解析，对应的值；
   3. 描述：简单介绍一下这个字段的用途，方便后期或团队协助查看；
   4. 是否启用：是否使用该字段开关；

   ![image-20230504172425841](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_4846159ee5c5ea7320a562d8a488a024.png)

   ![image-20230504172527952](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_4f43345a3f76888ae45a05563f4d153b.png)

3. 在my_sex字典中，可以将男对应值0，女对应值1

### 使用

例如性别字典使用：

1. 在数据字典中搜索相关字典，得到**字典编号**

   ![image-20230427162949685](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_a33308ae916daa18cc4285aea187a40c.png)

2. 在解析后的报表明细中的字典code中直接填写字典编码即可，即可将0,1,2的值转为男、女、未知

   ![image-20230427163134716](https://leezway-mark-down.oss-cn-hangzhou.aliyuncs.com/img/%E6%8A%A5%E8%A1%A8%E7%A4%BA%E4%BE%8BV4_Img/img_7b1e598712f2ae6d7c2c694cc8c20fb2.png)